"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@rongcloud/engine"),t=function(){return(t=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function n(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))}function o(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function r(e,t){for(var n=0,o=t.length,r=e.length;n<o;n++,r++)e[r]=t[n];return e}var s=new e.Logger("RCIM"),i={TIMEOUT:{code:-1,msg:"Network timeout"},SDK_INTERNAL_ERROR:{code:-2,msg:"SDK internal error"},PARAMETER_ERROR:{code:-3,msg:"Please check the parameters, the {param} expected a value of {expect} but received {current}"},REJECTED_BY_BLACKLIST:{code:405,msg:"Blacklisted by the other party"},SEND_TOO_FAST:{code:20604,msg:"Sending messages too quickly"},NOT_IN_GROUP:{code:22406,msg:"Not in group"},FORBIDDEN_IN_GROUP:{code:22408,msg:"Forbbiden from speaking in the group"},NOT_IN_CHATROOM:{code:23406,msg:"Not in chatRoom"},FORBIDDEN_IN_CHATROOM:{code:23408,msg:"Forbbiden from speaking in the chatRoom"},KICKED_FROM_CHATROOM:{code:23409,msg:"Kicked out and forbbiden from joining the chatRoom"},CHATROOM_NOT_EXIST:{code:23410,msg:"ChatRoom does not exist"},CHATROOM_IS_FULL:{code:23411,msg:"ChatRoom members exceeded"},PARAMETER_INVALID_CHATROOM:{code:23412,msg:"Invalid chatRoom parameters"},ROAMING_SERVICE_UNAVAILABLE_CHATROOM:{code:23414,msg:"ChatRoom message roaming service is not open, Please go to the developer to open this service"},RECALLMESSAGE_PARAMETER_INVALID:{code:25101,msg:"Invalid recall message parameter"},ROAMING_SERVICE_UNAVAILABLE_MESSAGE:{code:25102,msg:"Single group chat roaming service is not open, Please go to the developer to open this service"},PUSHSETTING_PARAMETER_INVALID:{code:26001,msg:"Invalid push parameter"},OPERATION_BLOCKED:{code:20605,msg:"Operation is blocked"},OPERATION_NOT_SUPPORT:{code:20606,msg:"Operation is not supported"},MSG_BLOCKED_SENSITIVE_WORD:{code:21501,msg:"The sent message contains sensitive words"},REPLACED_SENSITIVE_WORD:{code:21502,msg:"Sensitive words in the message have been replaced"},NOT_CONNECTED:{code:30001,msg:"Please connect successfully first"},NAVI_REQUEST_ERROR:{code:30007,msg:"Navigation http request failed"},CMP_REQUEST_ERROR:{code:30010,msg:"CMP sniff http request failed"},CONN_APPKEY_FAKE:{code:31002,msg:"Your appkey is fake"},CONN_MINI_SERVICE_NOT_OPEN:{code:31003,msg:"Mini program service is not open, Please go to the developer to open this service"},CONN_ACK_TIMEOUT:{code:31e3,msg:"Connection ACK timeout"},CONN_TOKEN_INCORRECT:{code:31004,msg:"Your token is not valid or expired"},CONN_NOT_AUTHRORIZED:{code:31005,msg:"AppKey and Token do not match"},CONN_REDIRECTED:{code:31006,msg:"Connection redirection"},CONN_APP_BLOCKED_OR_DELETED:{code:31008,msg:"AppKey is banned or deleted"},CONN_USER_BLOCKED:{code:31009,msg:"User blocked"},CONN_DOMAIN_INCORRECT:{code:31012,msg:"Connect domain error, Please check the set security domain"},ROAMING_SERVICE_UNAVAILABLE:{code:33007,msg:"Roaming service cloud is not open, Please go to the developer to open this service"},RC_CONNECTION_EXIST:{code:34001,msg:"Connection already exists"},CHATROOM_KV_EXCEED:{code:23423,msg:"ChatRoom KV setting exceeds maximum"},CHATROOM_KV_OVERWRITE_INVALID:{code:23424,msg:"ChatRoom KV already exists"},CHATROOM_KV_STORE_NOT_OPEN:{code:23426,msg:"ChatRoom KV storage service is not open, Please go to the developer to open this service"},CHATROOM_KEY_NOT_EXIST:{code:23427,msg:"ChatRoom key does not exist"},MSG_KV_NOT_SUPPORT:{code:34008,msg:"The message cannot be extended"},SEND_MESSAGE_KV_FAIL:{code:34009,msg:"Sending RC expansion message fail"},EXPANSION_LIMIT_EXCEET:{code:34010,msg:"The message expansion size is beyond the limit"},ILLGAL_PARAMS:{code:33003,msg:"Incorrect parameters passed in while calling the interface"},CHATROOM_KV_STORE_NOT_ALL_SUCCESS:{code:23428,msg:"Chatroom kv store not all success"},CHATROOM_KV_STORE_OUT_LIMIT:{code:23429,msg:"chatroom kv's length is out of limit"}},a={};for(var c in i){var u=i[c].code;a[u]=c}function d(t){var n=t.conversationType,o=t.messageType,r=t.content,s=t.senderUserId,i=t.targetId,a=t.sentTime,c=t.receivedTime,u=t.messageUId,d=t.messageDirection,g=t.isPersited,h=t.isCounted,p=t.isOffLineMessage,l=t.canIncludeExpansion,f=t.expansion,m=t.receivedStatus,C=t.disableNotification,v=t.isMentioned,S=t.isStatusMessage,I=t.readReceiptInfo;return m||(m=e.ReceivedStatus.UNREAD),{messageType:o,content:r,senderUserId:s,targetId:i,type:n,sentTime:a,receivedTime:c,messageUId:u,messageDirection:d,isPersited:g,isCounted:h,isOffLineMessage:p,isMentioned:v,disableNotification:C,isStatusMessage:S,canIncludeExpansion:l,expansion:f,receivedStatus:m,readReceiptInfo:I}}function g(e){var t=e.conversationType,n=e.targetId,o=e.latestMessage,r=e.unreadMessageCount,s=e.hasMentioned,i=e.mentionedInfo,a=e.lastUnreadTime,c=e.notificationStatus,u=e.isTop;return{type:t,targetId:n,latestMessage:o&&d(o),unreadMessageCount:r,hasMentioned:s,mentionedInfo:s?{type:null==i?void 0:i.type,userIdList:null==i?void 0:i.userIdList}:void 0,lastUnreadTime:a,notificationStatus:c,isTop:u}}function h(t){e.assert("options.messageType",t.messageType,e.AssertRules.STRING,!0),e.assert("options.content",t.content,(function(t){return e.isObject(t)}),!0),e.assert("options.isPersited",t.isPersited,e.AssertRules.BOOLEAN),e.assert("options.isCounted",t.isCounted,e.AssertRules.BOOLEAN),e.assert("options.pushContent",t.pushContent,e.AssertRules.STRING),e.assert("options.pushData",t.pushData,e.AssertRules.STRING),e.assert("options.isVoipPush",t.isVoipPush,e.AssertRules.BOOLEAN),e.assert("options.isStatusMessage",t.isStatusMessage,e.AssertRules.BOOLEAN),e.assert("options.isMentioned",t.isMentioned,e.AssertRules.BOOLEAN),e.assert("options.mentionedType",t.mentionedType,e.AssertRules.NUMBER),e.assert("options.mentionedUserIdList",t.mentionedUserIdList,(function(t){return e.isArray(t)&&(0===t.length||t.every(e.isString))})),e.assert("options.directionalUserIdList",t.directionalUserIdList,(function(t){return e.isArray(t)&&(0===t.length||t.every(e.isString))})),e.isUndefined(t.isPersited)&&e.isUndefined(t.isCounted)&&e.isUndefined(t.isStatusMessage)||s.warn("The parameters `isPersited`, `isCounted`, `isStatusMessage` will be deprecated in future releases due to inconsistance of the values on mobile side and web side. Please use `registerMessageType` instead for non-integrated message type.")}var p=function(e,t){if(!e)return[];var n=l(e),o=m(n.topConversationList,t),r=m(n.unToppedConversationList,t);return o.push.apply(o,r),o},l=function(t){var n=[],o=[];return e.forEach(t,(function(e){var t=e.hasMentioned,r=e.mentionedInfo;e.hasMentioned=t,e.mentionedInfo=r,e.isTop||!1?n.push(e):o.push(e)})),{topConversationList:n||[],unToppedConversationList:o||[]}},f=function(e){return e.type+"_"+e.targetId},m=function(e,t){return void 0===t&&(t=0),v(e,(function(e,n){n=n||{};var o=(e=e||{}).latestMessage||{},r=n.latestMessage||{},s=o.sentTime||0,i=r.sentTime||0;return t?i>=s:i<=s}))},C=function(t){var n=(t=t||{}).targetId,o=t.type,r=e.ConversationType.PRIVATE,s={messageType:e.MessageType.TextMessage,sentTime:e.DelayTimer.getTime(),content:{content:""},senderUserId:n,targetId:n,type:o};return t.type=o||r,t.targetId=n||"",t.latestMessage=t.latestMessage||s,t},v=function(e,t){var n=function(e,t,o,r){if(r=r||function(e,t){return e<=t},t<o){for(var s=e[o],i=t-1,a=void 0,c=t;c<=o;c++)r(e[c],s)&&(a=e[++i],e[i]=e[c],e[c]=a);n(e,t,i-1,r),n(e,i+1,o,r)}return e};return n(e,0,e.length-1,t)},S=function(t){return!t.type||!t.targetId||!e.isObject(t.latestMessage)||e.isUndefined(t.unreadMessageCount)},I=function(t,n,o){var r=(o=o||{}).isAllowNull;for(var s in t=t||{},n=n||{}){var i=n[s];e.isUndefined(i)&&!r||(t[s]=i)}return t},y=function(){function t(e,t){this._context=e,this.targetId=t.targetId,this.type=t.type}return t.prototype.destory=function(){return n(this,void 0,void 0,(function(){var t,n;return o(this,(function(o){switch(o.label){case 0:return[4,this._context.removeConversation(this.type,this.targetId)];case 1:return t=o.sent(),n="type:"+this.type+",targetId:"+this.targetId,s.debug("destroy conversation ->"+n),t!==e.ErrorCode.SUCCESS?(s.warn("destroy conversation fail ->"+t+":"+a[t]+","+n),[2,Promise.reject({code:t,msg:a[t]})]):[2]}}))}))},t.prototype.read=function(){return n(this,void 0,void 0,(function(){var t,n;return o(this,(function(o){switch(o.label){case 0:return[4,this._context.clearUnreadCount(this.type,this.targetId)];case 1:return t=o.sent(),n="type:"+this.type+",targetId:"+this.targetId,s.debug("clear unreadMsgNum ->"+n),t!==e.ErrorCode.SUCCESS?(s.warn("clear unreadMsgNum fail ->"+t+":"+a[t]+","+n),[2,Promise.reject({code:t,msg:a[t]})]):[2]}}))}))},t.prototype.getUnreadCount=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,this._context.getUnreadCount(this.type,this.targetId)];case 1:return t=o.sent(),n=t.code,r=t.data,i="type:"+this.type+",targetId:"+this.targetId,s.debug("get unreadCount ->"+i),n===e.ErrorCode.SUCCESS?[2,r]:(s.warn("get unreadCount fail ->"+n+":"+a[n]+","+i),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.send=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return h(t),Object.prototype.hasOwnProperty.call(t,"isPersited")||(t.isPersited=!0),Object.prototype.hasOwnProperty.call(t,"isCounted")||(t.isCounted=!0),n="type:"+this.type+",targetId:"+this.targetId,s.debug("send message  ->"+n),[4,this._context.sendMessage(this.type,this.targetId,t)];case 1:return r=o.sent(),i=r.code,c=r.data,i===e.ErrorCode.SUCCESS?[2,d(c)]:(s.warn("send message fail ->"+i+":"+a[i]+","+n),[2,Promise.reject({code:i,msg:a[i],data:d({isMentioned:!!t.isMentioned,content:t.content,messageType:t.messageType,isPersited:t.isPersited||!1,isCounted:t.isCounted||!1,disableNotification:!!(null==t?void 0:t.disableNotification),canIncludeExpansion:!!(null==t?void 0:t.canIncludeExpansion),expansion:(null==t?void 0:t.expansion)||null,conversationType:this.type,targetId:this.targetId,senderUserId:this._context.getCurrentUserId(),messageUId:"",messageDirection:e.MessageDirection.SEND,isOffLineMessage:!1,sentTime:(null==c?void 0:c.sentTime)||0,receivedTime:0,isStatusMessage:t.isStatusMessage||!1,receivedStatus:e.ReceivedStatus.UNREAD})})])}}))}))},t.prototype.setStatus=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.notificationStatus",t.notificationStatus,(function(e){return 1===e||2===e})),e.assert("options.isTop",t.isTop,e.AssertRules.BOOLEAN),n="type:"+this.type+",targetId:"+this.targetId,s.debug("set conversation status ->"+n),[4,this._context.setConversationStatus(this.type,this.targetId,t.isTop,t.notificationStatus)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("set conversation status fail ->"+r+":"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.getMessages=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c,u;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.timestamp",t.timestamp,e.AssertRules.NUMBER),e.assert("options.count",t.count,e.AssertRules.NUMBER),e.assert("options.order",t.order,(function(e){return 0===e||1===e})),n="type:"+this.type+",targetId:"+this.targetId,s.debug("get history message ->"+n),[4,this._context.getHistoryMessage(this.type,this.targetId,null==t?void 0:t.timestamp,null==t?void 0:t.count,null==t?void 0:t.order)];case 1:return r=o.sent(),i=r.code,c=r.data,i===e.ErrorCode.SUCCESS&&c?(u=c.list.map((function(e){return d(e)})),[2,Promise.resolve({list:u,hasMore:c.hasMore})]):(s.warn("get history message fail ->"+i+":"+a[i]+","+n),[2,Promise.reject({code:i,msg:a[i]})])}}))}))},t.prototype.recall=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c,u;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.messageUId",t.messageUId,e.AssertRules.STRING,!0),e.assert("options.sentTime",t.sentTime,e.AssertRules.NUMBER,!0),e.assert("options.disableNotification",null==t?void 0:t.disableNotification,e.AssertRules.BOOLEAN),e.assert("options.pushConfig",null==t?void 0:t.pushConfig,e.AssertRules.OBJECT),n={user:t.user,channelId:"",disableNotification:null==t?void 0:t.disableNotification,pushConfig:null==t?void 0:t.pushConfig},r="type:"+this.type+",targetId:"+this.targetId+",messageUId:"+t.messageUId,s.debug("recall message ->"+r),[4,this._context.recallMessage(this.type,this.targetId,t.messageUId,t.sentTime,n)];case 1:return i=o.sent(),c=i.code,u=i.data,c===e.ErrorCode.SUCCESS&&u?[2,d(u)]:(s.warn("recall message fail ->"+c+":"+a[c]+","+r),[2,Promise.reject({code:c,msg:a[c]})])}}))}))},t.prototype.deleteMessages=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e.assert("options",t,(function(t){return e.isArray(t)&&t.length}),!0),t.forEach((function(t){e.assert("options.messageUId",t.messageUId,e.AssertRules.STRING,!0),e.assert("options.sentTime",t.sentTime,e.AssertRules.NUMBER,!0),e.assert("options.messageDirection",t.messageDirection,(function(e){return 1===e||2===e}),!0)})),n="type:"+this.type+",targetId:"+this.targetId,s.debug("delete messages ->"+n),[4,this._context.deleteRemoteMessage(this.type,this.targetId,t)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("delete message fail ->"+r+":"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.clearMessages=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.timestamp",t.timestamp,e.AssertRules.NUMBER,!0),n="type:"+this.type+",targetId:"+this.targetId,s.debug("clear message ->"+n),[4,this._context.deleteRemoteMessageByTimestamp(this.type,this.targetId,t.timestamp)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("clear message ->"+r+":"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.updateMessageExpansion=function(t,r){return n(this,void 0,void 0,(function(){var n,i,c,u,d,g,h;return o(this,(function(o){switch(o.label){case 0:return e.assert("expansion",t,e.AssertRules.OBJECT,!0),e.assert("message",r,e.AssertRules.OBJECT,!0),n=r.type,i=r.targetId,c=r.messageUId,u=r.canIncludeExpansion,d=r.expansion,g="type:"+n+",targetId:"+this.targetId+",messageUId:"+c,s.debug("update message expansion ->"+g),[4,this._context.sendExpansionMessage({conversationType:n,targetId:i,messageUId:c,expansion:t,canIncludeExpansion:u,originExpansion:d,channelId:""})];case 1:return(h=o.sent().code)!==e.ErrorCode.SUCCESS?(s.warn("update message expansion fail ->"+h+":"+a[h]+","+g),[2,Promise.reject({code:h,msg:a[h]})]):[2]}}))}))},t.prototype.removeMessageExpansion=function(t,r){return n(this,void 0,void 0,(function(){var n,i,c,u,d,g;return o(this,(function(o){switch(o.label){case 0:return e.assert("keys",t,e.AssertRules.ARRAY,!0),e.assert("message",r,e.AssertRules.OBJECT,!0),n=r.type,i=r.targetId,c=r.messageUId,u=r.canIncludeExpansion,d="type:"+n+",targetId:"+this.targetId+",messageUId:"+c,s.debug("remove message expansion ->"+d),[4,this._context.sendExpansionMessage({conversationType:n,targetId:i,messageUId:c,canIncludeExpansion:u,keys:t,channelId:""})];case 1:return(g=o.sent().code)!==e.ErrorCode.SUCCESS?(s.warn("remove message expansion fail ->"+g+":"+a[g]+","+d),[2,Promise.reject({code:g,msg:a[g]})]):[2]}}))}))},t.prototype.setDraft=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e.assert("draft",t,e.AssertRules.STRING,!0),n="type:"+this.type+",targetId:"+this.targetId,s.debug("set draft ->"+n),[4,this._context.saveConversationMessageDraft(this.type,this.targetId,t)];case 1:return(r=o.sent())===e.ErrorCode.SUCCESS?[2,Promise.resolve()]:(s.warn("set draft fail ->"+r+":"+a[r]+","+n),[2])}}))}))},t.prototype.getDraft=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return[4,this._context.getConversationMessageDraft(this.type,this.targetId)];case 1:return t=o.sent(),n=t.code,r=t.data,i="type:"+this.type+",targetId:"+this.targetId,s.debug("get draft ->"+i),n===e.ErrorCode.SUCCESS?[2,Promise.resolve(r)]:(s.warn("get draft fail ->"+n+":"+a[n]+","+i),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.deleteDraft=function(){return n(this,void 0,void 0,(function(){var t,n;return o(this,(function(o){switch(o.label){case 0:return t="type:"+this.type+",targetId:"+this.targetId,s.debug("delete draft  ->"+t),[4,this._context.clearConversationMessageDraft(this.type,this.targetId)];case 1:return(n=o.sent())===e.ErrorCode.SUCCESS?[2,Promise.resolve()]:(s.warn("delete draft fail ->"+n+":"+a[n]+","+t),[2])}}))}))},t.prototype.sendReadReceiptMessage=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c,u;return o(this,(function(o){switch(o.label){case 0:for(e.assert("messageUIds",t,e.AssertRules.ARRAY,!0),n=0,r=t;n<r.length;n++)i=r[n],e.assert("messageUId",i,e.AssertRules.STRING);return c="messageUIds:"+t.join(",")+",targetId:"+this.targetId,s.debug("send read receipt message ->"+c),[4,this._context.sendReadReceiptMessage(this.targetId,t)];case 1:return(u=o.sent().code)===e.ErrorCode.SUCCESS?[2,Promise.resolve()]:(s.warn("send read receipt message fail ->"+u+":"+a[u]+","+c),[2,Promise.reject(u)])}}))}))},t.prototype.sendTypingStatusMessage=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c,u;return o(this,(function(o){switch(o.label){case 0:return e.assert("typingContentType",t,e.AssertRules.STRING,!0),n="type:"+this.type+",targetId:"+this.targetId,s.debug("send typing status message ->"+n),r={messageType:"RC:TypSts",content:{typingContentType:t},isStatusMessage:!0,channelId:""},[4,this._context.sendMessage(this.type,this.targetId,r)];case 1:return i=o.sent(),c=i.code,u=i.data,c===e.ErrorCode.SUCCESS?[2,d(u)]:(s.warn("send typing status message fail ->"+c+":"+a[c]+","+n),[2,Promise.reject({code:c,msg:a[c]})])}}))}))},t.prototype.getMessageReader=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return e.assert("messageUId",t,e.AssertRules.STRING,!0),n="messageUId:"+t+",targetId:"+this.targetId,s.debug("get message reader ->"+n),[4,this._context.getMessageReader(this.targetId,t)];case 1:return r=o.sent(),i=r.code,c=r.data,i===e.ErrorCode.SUCCESS?[2,Promise.resolve(c)]:(s.warn("get message reader fail ->"+i+":"+a[i]+","+n),[2,Promise.reject(i)])}}))}))},t.prototype.getInfo=function(){return n(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return[4,this._context.getConversation(this.type,this.targetId,"")];case 1:return t=o.sent(),n=t.code,r=t.data,n===e.ErrorCode.SUCCESS&&r?[2,g(r)]:[2,Promise.reject({code:n,msg:a[n]})]}}))}))},t.prototype.removeTags=function(t){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return e.assert("tagIds",t,e.AssertRules.ARRAY,!0),t.forEach((function(t){e.assert("tagId",t,e.AssertRules.STRING,!0)})),s.info("removeTags ->targetId:"+this.targetId+",type:"+this.type),[4,this._context.removeTagsForConversation({type:this.type,targetId:this.targetId},t)];case 1:return(n=o.sent().code)===e.ErrorCode.SUCCESS?[2,n]:(s.warn("removeTags fail ->"+n+":"+a[n]),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.getTags=function(){return n(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return s.info("getTags ->targetId:"+this.targetId+",type:"+this.type),[4,this._context.getTagsForConversation({type:this.type,targetId:this.targetId})];case 1:return t=o.sent(),n=t.code,r=t.data,n===e.ErrorCode.SUCCESS?[2,r||[]]:(s.warn("getTags fail ->"+n+":"+a[n]),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t}(),E=function(){function t(e){this._context=e}return t.prototype.getList=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return s.debug("get conversation list ->"),[4,this._context.getConversationList(null==t?void 0:t.count,void 0,null==t?void 0:t.startTime,null==t?void 0:t.order)];case 1:return n=o.sent(),r=n.code,i=n.data,r===e.ErrorCode.SUCCESS&&i?(c=i.map((function(e){return g(e)})),[2,p(c)]):(s.warn("get conversation list fail ->"+r+":"+a[r]),[2,Promise.reject({code:r,msg:a[r]})])}}))}))},t.prototype.get=function(t){return e.assert("options.type",t.type,e.isValidConversationType,!0),new y(this._context,t)},t.prototype.remove=function(t){return e.assert("options.type",t.type,e.isValidConversationType,!0),new y(this._context,t).destory()},t.prototype.getTotalUnreadCount=function(t,r){return n(this,void 0,void 0,(function(){var n,i,c,u,d,g;return o(this,(function(o){switch(o.label){case 0:if(s.debug("get total unread count -> ConversationType:"+JSON.stringify(r)+" includeMuted:"+t),e.assert("includeMuted",t,e.AssertRules.BOOLEAN,!1),e.assert("conversationTypes",r,e.AssertRules.ARRAY,!1),r)for(n=0,i=r;n<i.length;n++)c=i[n],e.assert("conversationType",c,e.AssertRules.NUMBER);return[4,this._context.getTotalUnreadCount("",r,t)];case 1:return u=o.sent(),d=u.code,g=u.data,d===e.ErrorCode.SUCCESS?[2,g]:(s.warn("getTotalUnreadCount fail ->"+d+":"+a[d]),[2,Promise.reject({code:d,msg:a[d]})])}}))}))},t.prototype.merge=function(t){return!t.conversationList&&s.warn("Parameter option.conversationList are required!"),function(t){var n=(t=t||{}).conversationList,o=t.updatedConversationList;n=n||[];var s=r(r([],o=o||[]),n),i={},a=[],c=[];return e.forEach(s,(function(t){if(e.isObject(t)){var n=t.type,o=t.targetId,r=f({type:n,targetId:o}),s=i[r]||{},u=e.isUndefined(s.index)?a.length:s.index,d=s.val||{},g=d.updatedItems||{},h=t.updatedItems;t=I(t,d),e.forEach(g,(function(e,n){t[n]=e.val})),e.forEach(h,(function(e,n){var o=(g[n]||{}).time||0;e.time>o&&(t[n]=e.val)})),i[r]={index:u,val:t},a[u]=t,S(t)&&c.push(u)}})),e.forEach(c,(function(e){var t=a[e];a[e]=C(t)})),a=p(a),e.map(a,(function(e){return delete e.updatedItems,e}))}(t)},t}(),T=function(){function t(e,t){this._context=e,this.tagId=t}return t.prototype.update=function(t){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return e.assert("tagName",t,e.AssertRules.STRING,!0),e.assert("tagName",t,(function(e){return e.length<=15})),s.info("update ->tagId:"+this.tagId+",tagName:"+t),[4,this._context.updateTag({tagId:this.tagId,tagName:t})];case 1:return(n=o.sent().code)===e.ErrorCode.SUCCESS?[2,n]:(s.warn("update ->code:"+n+",tagId:"+this.tagId),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.remove=function(){return n(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return s.info("remove ->tagId:"+this.tagId),[4,this._context.removeTag(this.tagId)];case 1:return(t=n.sent().code)===e.ErrorCode.SUCCESS?[2,t]:(s.warn("remove ->code:"+t+",tagId:"+this.tagId),[2,Promise.reject({code:t,msg:a[t]})])}}))}))},t.prototype.addConversations=function(t){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return e.assert("conversations",t,e.AssertRules.ARRAY,!0),t.forEach((function(t){e.assert("conversation.type",t.type,e.AssertRules.NUMBER,!0),e.assert("conversation.targetId",t.targetId,e.AssertRules.STRING,!0)})),s.info("addConversations ->tagId:"+this.tagId),[4,this._context.addTagForConversations(this.tagId,t)];case 1:return(n=o.sent().code)===e.ErrorCode.SUCCESS?[2,n]:(s.warn("addConversations ->code:"+n+",tagId:"+this.tagId),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.removeConversations=function(t){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return s.info("removeConversations ->tagId:"+this.tagId),[4,this._context.removeTagForConversations(this.tagId,t)];case 1:return(n=o.sent().code)===e.ErrorCode.SUCCESS?[2,n]:(s.warn("removeConversations ->code:"+n+",tagId:"+this.tagId),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.getConversationList=function(t,r){return n(this,void 0,void 0,(function(){var n,i,c,u;return o(this,(function(o){switch(o.label){case 0:return e.assert("count",r,e.AssertRules.NUMBER,!0),e.assert("startTime",t,e.AssertRules.NUMBER,!0),s.info("getConversationList ->tagId:"+this.tagId),[4,this._context.getConversationListByTag(this.tagId,t,r)];case 1:return n=o.sent(),i=n.data,c=n.code,u=[],c===e.ErrorCode.SUCCESS?((i=i||[]).forEach((function(e){var t=e.channelId,n=e.conversationType,o=e.targetId,r=e.unreadMessageCount,s=e.latestMessage,i=e.hasMentioned,a=e.mentionedInfo,c=e.notificationStatus,d=e.isTop,g=e.lastUnreadTime,h=e.isTopInTag;u.push({channelId:t,conversationType:n,targetId:o,unreadMessageCount:r,latestMessage:s,hasMentioned:i,mentionedInfo:a,notificationStatus:c,isTop:d,lastUnreadTime:g,isTopInTag:h})})),[2,u]):(s.warn("getConversationList ->code:"+c+",tagId:"+this.tagId),[2,Promise.reject({code:c,msg:a[c]})])}}))}))},t.prototype.getUnreadCount=function(t){return n(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return e.assert("isIncludeNotNotification",t,e.AssertRules.BOOLEAN,!0),s.info("getUnreadCount ->tagId:"+this.tagId),[4,this._context.getUnreadCountByTag(this.tagId,t)];case 1:return n=o.sent(),r=n.data,(i=n.code)===e.ErrorCode.SUCCESS?[2,r||0]:(s.warn("getUnreadCount ->code:"+i+",tagId:"+this.tagId),[2,Promise.reject({code:i,msg:a[i]})])}}))}))},t.prototype.updateConversationIsTop=function(t,r){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return e.assert("conversation.targetId",t.targetId,e.AssertRules.STRING,!0),e.assert("conversation.type",t.type,e.AssertRules.NUMBER,!0),e.assert("isTop",r,e.AssertRules.BOOLEAN,!0),s.info("updateConversationIsTop ->tagId:"+this.tagId),[4,this._context.setConversationStatusInTag(this.tagId,t,{isTop:r})];case 1:return(n=o.sent().code)===e.ErrorCode.SUCCESS?[2,n]:(s.warn("updateConversationIsTop ->code:"+n+",tagId:"+this.tagId),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t}(),R=function(){function t(e){this._context=e}return t.prototype.create=function(t){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){switch(o.label){case 0:return e.assert("tag.tagId",t.tagId,e.AssertRules.STRING,!0),e.assert("tag.tagId",t.tagId,(function(e){return e.length<=10})),e.assert("tag.tagName",t.tagName,(function(e){return e.length<=15})),e.assert("tag.tagName",t.tagName,e.AssertRules.STRING,!0),s.info("create tag->tagId:"+t.tagId+",tagName:"+t.tagName),[4,this._context.createTag(t)];case 1:return(n=o.sent().code)===e.ErrorCode.SUCCESS?[2,n]:(s.warn("create tag fail ->"+n+":"+a[n]),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.getTagInfoList=function(){return n(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return[4,this._context.getTagList()];case 1:return t=o.sent(),n=t.code,r=t.data,n===e.ErrorCode.SUCCESS?[2,r||[]]:(s.warn("getTagInfoList ->code:"+n),[2,Promise.reject({code:n,msg:a[n]})])}}))}))},t.prototype.get=function(t){return n(this,void 0,void 0,(function(){return o(this,(function(n){return e.assert("tag.tagId",t,e.AssertRules.STRING,!0),e.assert("tag.tagId",t,(function(e){return e.length<=10})),[2,new T(this._context,t)]}))}))},t}(),_=function(t){e.assert("options.key",t.key,e.AssertRules.STRING,!0),e.assert("options.value",t.value,e.AssertRules.STRING,!0),e.assert("options.isAutoDelete",t.isAutoDelete,e.AssertRules.BOOLEAN),e.assert("options.isSendNotification",t.isSendNotification,e.AssertRules.BOOLEAN),e.assert("options.notificationExtra",t.notificationExtra,e.AssertRules.STRING)},O=function(t){e.assert("options.key",t.key,e.AssertRules.STRING,!0),e.assert("options.isSendNotification",t.isSendNotification,e.AssertRules.BOOLEAN),e.assert("options.notificationExtra",t.notificationExtra,e.AssertRules.STRING)},N=function(){function t(e,t){this._context=e,this._id=t}return t.prototype.join=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.count",t.count,e.AssertRules.NUMBER,!0),n="id:"+this._id,s.debug("join chatroom ->"+n),[4,this._context.joinChatroom(this._id,t.count)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("join chatroom fail ->code+:"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.joinExist=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.count",t.count,e.AssertRules.NUMBER,!0),n="id:"+this._id,s.debug("join exist chatroom ->"+n),[4,this._context.joinExistChatroom(this._id,t.count)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("join exist chatroom fail ->code:"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.quit=function(){return n(this,void 0,void 0,(function(){var t,n;return o(this,(function(o){switch(o.label){case 0:return t="id:"+this._id,s.debug("quit chatroom ->"+t),[4,this._context.quitChatroom(this._id)];case 1:return(n=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("quit chatroom fail ->code+:"+a[n]+","+t),[2,Promise.reject({code:n,msg:a[n]})]):[2]}}))}))},t.prototype.getInfo=function(t){return void 0===t&&(t={}),n(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.count",t.count,e.AssertRules.NUMBER),e.assert("options.order",t.order,(function(e){return[0,1,2].includes(e)})),n="id:"+this._id,s.debug("get chatroom info ->"+n),[4,this._context.getChatroomInfo(this._id,t.count,t.order)];case 1:return r=o.sent(),i=r.code,c=r.data,i===e.ErrorCode.SUCCESS&&c?[2,c]:(s.warn("get chatroom info fail ->code+:"+a[i]+","+n),[2,Promise.reject({code:i,msg:a[i]})])}}))}))},t.prototype.setEntry=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return _(t),n="id:"+this._id,s.debug("set chatroom entry->"+n),[4,this._context.setChatroomEntry(this._id,t)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("set chatroom entry fail ->code+:"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.setEntries=function(t){return n(this,void 0,void 0,(function(){var n,r,c,u;return o(this,(function(o){switch(o.label){case 0:return function(t){t.entries.forEach((function(t){e.assert("entry.key",t.key,e.AssertRules.STRING,!0),e.assert("entry.value",t.value,e.AssertRules.STRING,!0)})),e.assert("options.isAutoDelete",t.isAutoDelete,e.AssertRules.BOOLEAN),e.assert("options.notificationExtra",t.notificationExtra,e.AssertRules.STRING)}(t),t.entries.length>10?[2,Promise.reject(i.CHATROOM_KV_STORE_OUT_LIMIT)]:(n="id:"+this._id,s.debug("set chatroom entry->"+n),[4,this._context.setChatroomEntries(this._id,t)]);case 1:return r=o.sent(),c=r.code,u=r.data,c!==e.ErrorCode.SUCCESS?(s.warn("set chatroom entry fail ->code+:"+a[c]+","+n),[2,Promise.reject({code:c,msg:a[c],data:u})]):[2]}}))}))},t.prototype.forceSetEntry=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return _(t),n="id:"+this._id,s.debug("force set chatroom entry ->"+n),[4,this._context.forceSetChatroomEntry(this._id,t)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("force set chatroom entry fail ->code+:"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.removeEntry=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return O(t),n="id:"+this._id,s.debug("remove chatroom entry->"+n),[4,this._context.removeChatroomEntry(this._id,t)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("remove chatroom entry fail ->code+:"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.removeEntries=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c,u;return o(this,(function(o){switch(o.label){case 0:return function(t){t.entries.forEach((function(t){e.assert("key",t,e.AssertRules.STRING,!0)}))}(t),n="id:"+this._id,s.debug("remove chatroom entry->"+n),(r=Object.assign({},t)).entries=t.entries.map((function(e){return{key:e}})),[4,this._context.removeChatroomEntries(this._id,r)];case 1:return i=o.sent(),c=i.code,u=i.data,c!==e.ErrorCode.SUCCESS?(s.warn("remove chatroom entry fail ->code+:"+a[c]+","+n),[2,Promise.reject({code:c,msg:a[c],data:u})]):[2]}}))}))},t.prototype.forceRemoveEntry=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return O(t),n="id:"+this._id,s.debug("force remove chatroom entry ->"+n),[4,this._context.forceRemoveChatroomEntry(this._id,t)];case 1:return(r=o.sent())!==e.ErrorCode.SUCCESS?(s.warn("force remove chatroom entry fail ->code+:"+a[r]+","+n),[2,Promise.reject({code:r,msg:a[r]})]):[2]}}))}))},t.prototype.getEntry=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return e.assert("key",t,(function(t){return e.isString(t)&&/[\w+=-]+/.test(t)&&t.length<=128}),!0),n="id:"+this._id,s.debug("get chatroom entry->"+n),[4,this._context.getChatroomEntry(this._id,t)];case 1:return r=o.sent(),i=r.code,c=r.data,i===e.ErrorCode.SUCCESS&&c?[2,c]:(s.warn("get chatroom entry fail ->code+:"+a[i]+","+n),[2,Promise.reject({code:i,msg:a[i]})])}}))}))},t.prototype.getAllEntries=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t="id:"+this._id,s.debug("get all chatroom entries->"+t),[4,this._context.getAllChatroomEntries(this._id)];case 1:return n=o.sent(),r=n.code,i=n.data,r===e.ErrorCode.SUCCESS&&i?[2,i]:(s.warn("get all chatroom entries fail ->code+:"+a[r]+","+t),[2,Promise.reject({code:r,msg:a[r]})])}}))}))},t.prototype.send=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return h(t),n="id:"+this._id,s.debug("send chatroom message ->"+n),Object.prototype.hasOwnProperty.call(t,"isPersited")||(t.isPersited=!0),Object.prototype.hasOwnProperty.call(t,"isCounted")||(t.isCounted=!0),[4,this._context.sendMessage(e.ConversationType.CHATROOM,this._id,t)];case 1:return r=o.sent(),i=r.code,c=r.data,i===e.ErrorCode.SUCCESS?[2,d(c)]:(s.warn("send chatroom message fail ->code+:"+a[i]+","+n),[2,Promise.reject({code:i,msg:a[i]})])}}))}))},t.prototype.getMessages=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.timestamp",t.timestamp,e.AssertRules.NUMBER),e.assert("options.count",t.count,e.AssertRules.NUMBER),e.assert("options.order",t.order,(function(e){return 0===e||1===e})),n="id:"+this._id,s.debug("get chatroom history message->"+n),[4,this._context.getChatRoomHistoryMessages(this._id,t.count,t.order,t.timestamp)];case 1:return r=o.sent(),i=r.code,c=r.data,i===e.ErrorCode.SUCCESS&&c?[2,{list:c.list.map((function(e){return d(e)})),hasMore:c.hasMore}]:(s.warn("get chatroom history message fail ->code+:"+a[i]+","+n),[2,Promise.reject({code:i,msg:a[i]})])}}))}))},t.prototype.recall=function(t){return n(this,void 0,void 0,(function(){var n,r,i,c,u;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.messageUId",t.messageUId,e.AssertRules.STRING,!0),e.assert("options.sentTime",t.sentTime,e.AssertRules.NUMBER,!0),n="id:"+this._id+",messageUId:"+t.messageUId,s.debug("chatroom recall->"+n),r=e.ConversationType.CHATROOM,[4,this._context.recallMessage(r,this._id,t.messageUId,t.sentTime,{channelId:"",user:t.user})];case 1:return i=o.sent(),c=i.code,u=i.data,c===e.ErrorCode.SUCCESS&&u?[2,d(u)]:(s.warn("chatroom recall fail->code+:"+a[c]+","+n),[2,Promise.reject({code:c,msg:a[c]})])}}))}))},t}(),w=function(){function t(e){this._context=e}return t.prototype.get=function(t){return e.assert("option.id",t.id,e.notEmptyString,!0),new N(this._context,t.id)},t}(),b=function(){function r(e,t){this._options=e,this._context=t,this._roomId=e.id}return r.prototype.join=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t="roomId:"+this._roomId,s.debug("join ->"+t),[4,this._context.joinRTCRoom(this._roomId,this._options.mode,this._options.broadcastType)];case 1:return n=o.sent(),r=n.code,i=n.data,r===e.ErrorCode.SUCCESS?[2,i]:(s.warn("join fail ->"+r+":"+a[r]+","+t),[2,Promise.reject(r)])}}))}))},r.prototype.quit=function(){return n(this,void 0,void 0,(function(){var t,n;return o(this,(function(o){switch(o.label){case 0:return t="roomId:"+this._roomId,s.debug("quit ->"+t),[4,this._context.quitRTCRoom(this._roomId)];case 1:return(n=o.sent())===e.ErrorCode.SUCCESS?[2,n]:(s.warn("quit fail ->"+n+":"+a[n]+","+t),[2,Promise.reject(n)])}}))}))},r.prototype.getRoomInfo=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t="roomId:"+this._roomId,s.debug("get roomInfo ->"+t),[4,this._context.getRTCRoomInfo(this._roomId)];case 1:return n=o.sent(),r=n.code,i=n.data,r===e.ErrorCode.SUCCESS?[2,i]:(s.warn("get roomInfo fail ->"+r+":"+a[r]+","+t),[2,Promise.reject(r)])}}))}))},r.prototype.setUserInfo=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId+",key:"+t.key+",value:"+t.value,s.debug("set userInfo ->"+n),[4,this._context.setRTCUserInfo(this._roomId,t.key,t.value)];case 1:return(r=o.sent())===e.ErrorCode.SUCCESS?[2,r]:(s.warn("set userInfo fail ->"+r+":"+a[r]+","+n),[2,Promise.reject(r)])}}))}))},r.prototype.removeUserInfo=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId+",keys:"+(t.keys||[]).join(","),s.debug("remove useerInfo ->"+n),[4,this._context.removeRTCUserInfo(this._roomId,t.keys)];case 1:return(r=o.sent())===e.ErrorCode.SUCCESS?[2,r]:(s.warn("remove userInfo fail ->"+r+":"+a[r]+","+n),[2,Promise.reject(r)])}}))}))},r.prototype.setData=function(t,r,i,c,u){return n(this,void 0,void 0,(function(){var n,d;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId+",key:"+t+",value:"+r,s.debug("set data ->"+n),[4,this._context.setRTCData(this._roomId,t,r,i,c,u)];case 1:return(d=o.sent())===e.ErrorCode.SUCCESS?[2,d]:(s.warn("set data fail ->"+d+":"+a[d]+","+n),[2,Promise.reject(d)])}}))}))},r.prototype.setUserData=function(t,n,o,r){return this.setData(t,n,o,e.RTCApiType.PERSON,r)},r.prototype.setRTCUserData=function(t,r,i){return n(this,void 0,void 0,(function(){var n,c;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId,s.debug("set rtc user ->"+n),[4,this._context.setRTCTotalRes(this._roomId,t,r,i)];case 1:return(c=o.sent())===e.ErrorCode.SUCCESS?[2,c]:(s.warn("set rtc user fail ->"+c+":"+a[c]+","+n),[2,Promise.reject(c)])}}))}))},r.prototype.getData=function(t,r,i){return n(this,void 0,void 0,(function(){var n,c,u,d;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId,s.debug("get data ->"+n),[4,this._context.getRTCData(this._roomId,t,r,i)];case 1:return c=o.sent(),u=c.code,d=c.data,u===e.ErrorCode.SUCCESS?[2,d]:(s.warn("get data fail ->"+u+":"+a[u]+","+n),[2,Promise.reject(u)])}}))}))},r.prototype.getUserData=function(t,n){return this.getData(t,n,e.RTCApiType.PERSON)},r.prototype.removeData=function(t,r,i,c){return n(this,void 0,void 0,(function(){var n,u;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId+",keys:"+t.join(","),s.debug("remove data ->"+n),[4,this._context.removeRTCData(this._roomId,t,r,i,c)];case 1:return(u=o.sent())===e.ErrorCode.SUCCESS?[2,u]:(s.warn("remove data fail ->"+u+":"+a[u]+","+n),[2,Promise.reject(u)])}}))}))},r.prototype.removeUserData=function(t,n,o){return this.removeData(t,n,e.RTCApiType.PERSON,o)},r.prototype.setRoomData=function(t,n,o,r){return this.setData(t,n,o,e.RTCApiType.ROOM,r)},r.prototype.getRoomData=function(t,n){return this.getData(t,n,e.RTCApiType.ROOM)},r.prototype.removeRoomData=function(t,n,o){return this.removeData(t,n,e.RTCApiType.ROOM,o)},r.prototype.setState=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId,s.debug("set state ->"+n),[4,this._context.setRTCState(this._roomId,t.report)];case 1:return(r=o.sent())===e.ErrorCode.SUCCESS?[2,r]:(s.warn("set state fail ->"+r+":"+a[r]+","+n),[2,Promise.reject(r)])}}))}))},r.prototype.getUserList=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t="roomId:"+this._roomId,s.debug("get userList ->"+t),[4,this._context.getRTCUserInfoList(this._roomId)];case 1:return n=o.sent(),r=n.code,i=n.data,r===e.ErrorCode.SUCCESS?[2,i]:(s.warn("get userList fail ->"+r+":"+a[r]+","+t),[2,Promise.reject(r)])}}))}))},r.prototype.getUserInfoList=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t="roomId:"+this._roomId,s.debug("get userInfo list ->"+t),[4,this._context.getRTCUserInfoList(this._roomId)];case 1:return n=o.sent(),r=n.code,i=n.data,r===e.ErrorCode.SUCCESS?[2,null==i?void 0:i.users]:(s.warn("get userInfo list fail ->"+r+":"+a[r]+","+t),[2,Promise.reject(r)])}}))}))},r.prototype.getToken=function(){return n(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t="roomId:"+this._roomId,s.debug("getToken ->"+t),[4,this._context.getRTCToken(this._roomId,this._options.mode,this._options.broadcastType)];case 1:return n=o.sent(),r=n.data,(i=n.code)===e.ErrorCode.SUCCESS?[2,r]:(s.warn("getToken fail ->"+i+":"+a[i]+","+t),[2,Promise.reject(i)])}}))}))},r.prototype.ping=function(){return n(this,void 0,void 0,(function(){var t,n;return o(this,(function(o){switch(o.label){case 0:return t="roomId:"+this._roomId,s.debug("ping ->"+t),[4,this._context.rtcPing(this._roomId,this._options.mode,this._options.broadcastType)];case 1:return(n=o.sent())===e.ErrorCode.SUCCESS?[2,n]:(s.warn("ping fail ->"+n+":"+a[n]+","+t),[2,Promise.reject(n)])}}))}))},r.prototype.send=function(r){return n(this,void 0,void 0,(function(){var n,i,c,u;return o(this,(function(o){switch(o.label){case 0:return n="roomId:"+this._roomId,s.debug("send ->"+n),[4,this._context.sendMessage(e.ConversationType.RTC_ROOM,this._roomId,{content:t({},r.content),messageType:r.messageType})];case 1:return i=o.sent(),c=i.code,u=i.data,c===e.ErrorCode.SUCCESS?[2,u]:(s.warn("send fail ->"+c+":"+a[c]+","+n),[2,Promise.reject(c)])}}))}))},r}(),M=function(){return!("undefined"==typeof uni||!function(e){for(var t=["canIUse","getSystemInfo"],n=0,o=t.length;n<o;n++)if(!e[t[n]])return!1;return!0}(uni))},A=M();var U={tag:"browser",httpReq:function(t){var n=t.method||e.HttpMethod.GET,o=t.timeout||6e4,r=t.headers,s=t.query,i=t.body,a=e.appendUrl(t.url,s);return new Promise((function(e){var t,s=(t="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,"undefined"!=typeof XMLHttpRequest&&t?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")),c="[object XDomainRequest]"===Object.prototype.toString.call(s);if(s.open(n,a),r&&s.setRequestHeader)for(var u in r)s.setRequestHeader(u,r[u]);if(c){s.timeout=o,s.onload=function(){e({data:s.responseText,status:s.status||200})},s.onerror=function(){e({status:s.status||0})},s.ontimeout=function(){e({status:s.status||0})};var d="object"==typeof i?JSON.stringify(i):i;s.send(d)}else s.onreadystatechange=function(){4===s.readyState&&e({data:s.responseText,status:s.status})},s.onerror=function(){e({status:s.status||0})},setTimeout((function(){return e({status:s.status||0})}),o),s.send(i)}))},localStorage:null===window||void 0===window?void 0:window.localStorage,sessionStorage:null===window||void 0===window?void 0:window.sessionStorage,isSupportSocket:function(){var e="undefined"!=typeof WebSocket;return e||s.warn("websocket not support"),e},useNavi:!0,connectPlatform:"",isFromUniapp:A,createWebSocket:function(e,t){var n=new WebSocket(e,t);return n.binaryType="arraybuffer",{onClose:function(e){n.onclose=function(t){var n=t.code,o=t.reason;e(n,o)}},onError:function(e){n.onerror=e},onMessage:function(e){n.onmessage=function(t){e(t.data)}},onOpen:function(e){n.onopen=e},send:function(e){n.send(e)},close:function(e,t){n.close(e,t)}}},createDataChannel:function(t,n){return this.isSupportSocket()&&"websocket"===n?new e.WebSocketChannel(this,t):new e.CometChannel(this,t)}},x=M(),P=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return wx[e].apply(wx,t)}catch(e){s.error(e)}}},L={setItem:P("setStorageSync"),getItem:P("getStorageSync"),removeItem:P("removeStorageSync"),clear:P("clearStorageSync")},D={tag:"wechat",httpReq:function(t){var n=t.method||e.HttpMethod.GET,o=t.timeout||6e4,r=t.headers,s=t.query,i=t.body,a=e.appendUrl(t.url,s);return new Promise((function(t){wx.request({url:a,method:n,headers:r,timeout:o,data:i,success:function(e){t({data:e.data,status:e.statusCode})},fail:function(){t({status:e.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:L,sessionStorage:L,isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:x,createWebSocket:function(e,t){var n=wx.connectSocket({url:e,protocols:t});return{onClose:function(e){n.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){e(t.data)}))},onOpen:function(e){n.onOpen(e)},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(t,n){return"websocket"===n?new e.WebSocketChannel(this,t):new e.CometChannel(this,t)}},j=M(),k=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return my[e].apply(my,t)}catch(e){s.error(e)}}},B={setItem:k("setStorageSync"),getItem:k("getStorageSync"),removeItem:k("removeStorageSync"),clear:k("clearStorageSync")},G={tag:"alipay",httpReq:function(t){var n=t.method||e.HttpMethod.GET,o=t.timeout||6e4,r=t.headers,s=t.query,i=t.body,a=e.appendUrl(t.url,s);return new Promise((function(t){my.request({url:a,method:n,headers:r,timeout:o,data:i,success:function(e){t({data:e.data,status:e.status})},fail:function(){t({status:e.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:B,sessionStorage:B,isSupportSocket:function(){return!1},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:j,createDataChannel:function(t,n){return"websocket"===n?new e.WebSocketChannel(this,t):new e.CometChannel(this,t)}},V=M(),F=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return console.log("tt",tt),tt[e].apply(tt,t)}catch(e){s.error(e)}}},H={setItem:F("setStorageSync"),getItem:F("getStorageSync"),removeItem:F("removeStorageSync"),clear:F("clearStorageSync")},K={tag:"toutiao",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:V,localStorage:H,sessionStorage:H,httpReq:function(e){return new Promise((function(t,n){tt.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("调用成功",e.data);var n=(null==e?void 0:e.data)||{},o={data:JSON.stringify(n),status:e.statusCode};t(o)},fail:function(e){console.log("调用失败",e.errMsg),n({data:e.errMsg})}})}))},createWebSocket:function(e,t){var n=tt.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(t,n){return"websocket"===n?new e.WebSocketChannel(this,t):new e.CometChannel(this,t)}},q=M(),W=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return console.log("swan",swan),swan[e].apply(swan,t)}catch(e){s.error(e)}}},Y={setItem:W("setStorageSync"),getItem:W("getStorageSync"),removeItem:W("removeStorageSync"),clear:W("clearStorageSync")},X={tag:"baidu",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:q,localStorage:Y,sessionStorage:Y,httpReq:function(e){return new Promise((function(t,n){swan.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("调用成功",e.data);var n=(null==e?void 0:e.data)||{},o={data:JSON.stringify(n),status:e.statusCode};t(o)},fail:function(e){console.log("调用失败",e.errorCode),n({data:e.errorCode})}})}))},createWebSocket:function(e,t){var n=swan.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(t,n){return"websocket"===n?new e.WebSocketChannel(this,t):new e.CometChannel(this,t)}},J=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return uni[e].apply(uni,t)}catch(e){s.error(e)}}},Q={setItem:J("setStorageSync"),getItem:J("getStorageSync"),removeItem:J("removeStorageSync"),clear:J("clearStorageSync")},z={tag:"uniapp",httpReq:function(t){var n=t.method||e.HttpMethod.GET,o=t.timeout||6e4,r=t.headers,s=t.query,i=t.body,a=e.appendUrl(t.url,s);return new Promise((function(t){uni.request({url:a,method:n,headers:r,timeout:o,sslVerify:!1,data:i,success:function(e){t({data:e.data,status:e.statusCode})},fail:function(){t({status:e.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:Q,sessionStorage:Q,isSupportSocket:function(){return!0},useNavi:!0,connectPlatform:"",isFromUniapp:!0,createWebSocket:function(e,t){var n={complete:function(){},url:e,protocols:t},o=uni.connectSocket(n);return{onClose:function(e){o.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){o.onError((function(t){e(t.errMsg)}))},onMessage:function(e){o.onMessage((function(t){e(t.data)}))},onOpen:function(e){o.onOpen(e)},send:function(e){o.send({data:e})},close:function(e,t){o.close({code:e,reason:t})}}},createDataChannel:function(t,n){return"websocket"===n?new e.WebSocketChannel(this,t):new e.CometChannel(this,t)}},Z=function(e){return e&&e.canIUse&&e.getSystemInfo},$="undefined"!=typeof uni&&Z(uni)?function(){switch(process.env.VUE_APP_PLATFORM){case"app-plus":return z;case"mp-baidu":return X;case"mp-toutiao":return K;case"mp-alipay":return G;case"mp-weixin":return D;case"h5":default:return U}}():"undefined"!=typeof wx&&Z(wx)?D:"undefined"!=typeof my&&Z(my)?G:"undefined"!=typeof tt&&Z(tt)?K:"undefined"!=typeof swan&&Z(swan)?X:U;e.VersionManage.add("imlib","4.5.1"),e.VersionManage.validEngine("~4.5.1")||s.error("The current engine version '"+e.VersionManage.getInfo().engine+"' error，imlib required engine version at least '~4.5.1'.");var ee,te=[],ne=[],oe={message:function(e){te.forEach((function(t){return t(e)}))},status:function(e){ne.forEach((function(t){return t(e)}))}},re=function(){function t(t){this._token="",this._context=t,this.Conversation=new E(t),this.ChatRoom=new w(t),this.Tag=new R(t),this.RTC=function(n){return e.assert("options.id",n.id,e.notEmptyString,!0),new b(n,t)}}return t.prototype.install=function(e,t){return this._context.install(e,t)},t.prototype.watch=function(e){var t=e.status,n=e.conversation,o=e.message,r=e.chatroom,i=e.expansion,a=e.typingStatus,c=e.pullFinished,u=e.messageBlocked,g=e.tag,h={};t&&(h.connectionState=function(e){try{t({status:e})}catch(e){s.error(e)}}),n&&(h.conversationState=function(e){try{var t=e.map((function(e){return n=(t=e).updatedItems,o=t.conversationType,r=t.targetId,s=t.latestMessage,i=t.unreadMessageCount,a=t.lastUnreadTime,c=t.notificationStatus,u=t.isTop,g=t.mentionedInfo,h=t.hasMentioned,p=s&&d(s),n&&n.latestMessage&&(n.latestMessage.val=p),{updatedItems:n,type:o,targetId:r,latestMessage:p,unreadMessageCount:i,lastUnreadTime:a,notificationStatus:c,isTop:u,mentionedInfo:g,hasMentioned:h};var t,n,o,r,s,i,a,c,u,g,h,p}));n({updatedConversationList:t})}catch(e){s.error(e)}}),o&&(h.message=function(e){try{o({message:d(e)})}catch(e){s.error(e)}}),r&&(h.chatroomState=function(e){try{r(e)}catch(e){s.error(e)}}),i&&(h.expansion=function(e){try{i(e)}catch(e){s.error(e)}}),c&&(h.pullFinished=function(){try{c()}catch(e){s.error(e)}}),a&&(h.typingState=function(e){try{a(e)}catch(e){s.error(e)}}),u&&(h.messageBlocked=function(e){try{u(e)}catch(e){s.error(e)}}),g&&(h.tag=function(){try{g()}catch(e){s.error(e)}}),this._context.assignWatcher(h)},t.prototype.unwatch=function(){this._context.assignWatcher({message:void 0,connectionState:void 0,conversationState:void 0,chatroomState:void 0,expansion:void 0,pullFinished:void 0,typingState:void 0,messageBlocked:void 0})},t.prototype.rtcInnerWatch=function(e){var t=e.message,n=e.status;t&&te.push((function(e){try{t({message:d(e)})}catch(e){s.error(e)}})),n&&ne.push((function(e){try{n({status:e})}catch(e){s.error(e)}})),this._context.assignWatcher({rtcInnerWatcher:oe})},t.prototype.rtcInnerUnwatch=function(){ne.length=ne.length=0,this._context.assignWatcher({rtcInnerWatcher:void 0})},t.prototype.connect=function(t){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return e.assert("options.token",t.token,e.AssertRules.STRING,!0),n=t.token,this._token=n,[4,this._context.connect(n,!0)];case 1:return(r=o.sent()).code===e.ErrorCode.SUCCESS?[2,{id:r.userId}]:[2,Promise.reject({code:r.code,msg:a[r.code]})]}}))}))},t.prototype.reconnect=function(){return n(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this._context.reconnect()];case 1:return(t=n.sent()).code===e.ErrorCode.SUCCESS?[2,{id:t.userId}]:[2,Promise.reject({code:t.code,msg:a[t.code]})]}}))}))},t.prototype.disconnect=function(){return this._context.disconnect()},t.prototype.getAppInfo=function(){return{appkey:this._context.appkey,token:this._token,navi:this._context.getInfoFromCache()}},t.prototype.getConnectedTime=function(){return this._context.getConnectedTime()},t.prototype.getServerTime=function(){return this._context.getServerTime()},t.prototype.getConnectionStatus=function(){return this._context.getConnectionStatus()},t.prototype.getConnectionUserId=function(){return this._context.getCurrentUserId()},t.prototype.getFileToken=function(t,n,o,r){return e.assert("fileType",t,e.isValidFileType,!0),this._context.getFileToken(t,n,o,r)},t.prototype.getFileUrl=function(t,n,o,r,s){return e.assert("fileType",t,e.isValidFileType,!0),e.assert("filename",n,e.AssertRules.STRING),e.assert("saveName",o,e.AssertRules.STRING),e.assert("serverType",s,e.AssertRules.NUMBER),this._context.getFileUrl(t,n,o,r,s)},t.prototype.changeUser=function(t){return n(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return s.warn("Method is deprecated"),e.assert("options.token",t.token,e.AssertRules.STRING,!0),[4,this.disconnect()];case 1:return n.sent(),[2,this.connect(t)]}}))}))},t.prototype.registerMessageType=function(e,t,n,o){this._context.registerMessageType(e,t,n,o)},t}(),se=e.MessageDirection,ie=e.ConversationType,ae=e.FileType,ce={DO_NOT_DISTURB:e.NotificationStatus.OPEN,NOTIFY:e.NotificationStatus.CLOSE},ue=e.ChatroomEntryType;Object.defineProperty(exports,"ChatroomEntryType",{enumerable:!0,get:function(){return e.ChatroomEntryType}}),Object.defineProperty(exports,"ConnectionStatus",{enumerable:!0,get:function(){return e.ConnectionStatus}}),Object.defineProperty(exports,"ConversationType",{enumerable:!0,get:function(){return e.ConversationType}}),Object.defineProperty(exports,"FileType",{enumerable:!0,get:function(){return e.FileType}}),Object.defineProperty(exports,"LogLevel",{enumerable:!0,get:function(){return e.LogLevel}}),Object.defineProperty(exports,"MessageDirection",{enumerable:!0,get:function(){return e.MessageDirection}}),Object.defineProperty(exports,"NotificationStatus",{enumerable:!0,get:function(){return e.NotificationStatus}}),Object.defineProperty(exports,"UploadMethod",{enumerable:!0,get:function(){return e.UploadMethod}}),exports.CHATROOM_ENTRY_TYPE=ue,exports.CHATROOM_ORDER={ASC:1,DESC:2},exports.CONNECTION_STATUS={CONNECTED:0,CONNECTING:1,DISCONNECTED:2,NETWORK_UNAVAILABLE:3,SOCKET_ERROR:4,KICKED_OFFLINE_BY_OTHER_CLIENT:6,BLOCKED:12},exports.CONNECT_TYPE={COMET:"comet",WEBSOCKET:"websocket"},exports.CONVERSATION_TYPE=ie,exports.ERROR_CODE=a,exports.FILE_TYPE=ae,exports.IMClient=re,exports.MENTIONED_TYPE={ALL:1,SINGAL:2},exports.MESSAGE_DIRECTION=se,exports.MESSAGE_TYPE={TEXT:"RC:TxtMsg",VOICE:"RC:VcMsg",HQ_VOICE:"RC:HQVCMsg",IMAGE:"RC:ImgMsg",GIF:"RC:GIFMsg",RICH_CONTENT:"RC:ImgTextMsg",LOCATION:"RC:LBSMsg",FILE:"RC:FileMsg",SIGHT:"RC:SightMsg",COMBINE:"RC:CombineMsg",CHRM_KV_NOTIFY:"RC:chrmKVNotiMsg",LOG_COMMAND:"RC:LogCmdMsg",EXPANSION_NOTIFY:"RC:MsgExMsg",REFERENCE:"RC:ReferenceMsg"},exports.MESSAGS_TIME_ORDER={DESC:0,ASC:1},exports.NOTIFICATION_STATUS=ce,exports.RECALL_MESSAGE_TYPE="RC:RcCmd",exports.RECEIVED_STATUS={READ:1,LISTENED:2,DOWNLOADED:4,RETRIEVED:8,UNREAD:0},exports.SDK_VERSION="4.5.1",exports.getInstance=function(){return ee||s.error("Please call the init method first"),ee},exports.init=function(t){if(s.setLogLevel(t.logLevel),s.setLogStdout(t.logStdout),ee)return s.error("The instance already exists. Do not repeatedly call the init method"),ee;e.assert("options.appkey",t.appkey,e.AssertRules.STRING,!0),e.assert("options.debug",t.debug,e.AssertRules.BOOLEAN),e.assert("options.navigators",t.navigators,(function(t){return e.isArray(t)&&(0===t.length||t.every(e.isHttpUrl))}));var n=null==t?void 0:t.connectType;n?e.CONNECTION_TYPE.WEBSOCKET!==n&&e.CONNECTION_TYPE.COMET!==n&&(s.warn("RongIMLib connectionType must be "+e.CONNECTION_TYPE.WEBSOCKET+" or "+e.CONNECTION_TYPE.COMET),n=e.CONNECTION_TYPE.WEBSOCKET):n=e.CONNECTION_TYPE.WEBSOCKET;var o=e.APIContext.init($,{appkey:t.appkey,apiVersion:"4.5.1",navigators:t.navigators||[],miniCMPProxy:t.customCMP||[],connectionType:n,logLevel:t.logLevel,logStdout:t.logStdout,indexDBSwitch:t.indexDBSwitch,checkCA:t.checkCA});return s.warn("RongIMLib Version: 4.5.1, Commit: b3fede6623187cfd78369f9fc81cc5b70226faf9"),ee=new re(o)};
