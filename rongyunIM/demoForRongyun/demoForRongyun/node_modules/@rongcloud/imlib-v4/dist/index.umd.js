!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@rongcloud/engine")):"function"==typeof define&&define.amd?define(["exports","@rongcloud/engine"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).RongIMLib={},e.RCEngine)}(this,(function(e,t){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,r,n,o,a,s){try{var i=e[a](s),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var s=e.apply(t,r);function i(e){n(s,o,a,i,u,"next",e)}function u(e){n(s,o,a,i,u,"throw",e)}i(void 0)}))}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=p(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,i=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){i=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(i)throw a}}}}var h="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function m(e){var t={exports:{}};return e(t,t.exports),t.exports}m((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",i=o.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new _(n||[]);return a._invoke=function(e,t,r){var n=d;return function(o,a){if(n===l)throw new Error("Generator is already running");if(n===g){if("throw"===o)throw a;return k()}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var i=T(s,r);if(i){if(i===h)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=l;var u=f(e,t,r);if("normal"===u.type){if(n=r.done?g:p,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=g,r.method="throw",r.arg=u.arg)}}}(e,r,s),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d="suspendedStart",p="suspendedYield",l="executing",g="completed",h={};function m(){}function v(){}function y(){}var S={};S[a]=function(){return this};var C=Object.getPrototypeOf,E=C&&C(C(O([])));E&&E!==r&&n.call(E,a)&&(S=E);var R=y.prototype=m.prototype=Object.create(S);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function r(o,a,s,i){var u=f(e[o],e,a);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,i)}),(function(e){r("throw",e,s,i)})):t.resolve(d).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,i)}))}i(u.arg)}var o;this._invoke=function(e,n){function a(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(a,a):a()}}function T(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=f(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function O(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:k}}function k(){return{value:t,done:!0}}return v.prototype=R.constructor=y,y.constructor=v,v.displayName=u(y,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,u(e,i,"GeneratorFunction")),e.prototype=Object.create(R),e},e.awrap=function(e){return{__await:e}},b(I.prototype),I.prototype[s]=function(){return this},e.AsyncIterator=I,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var s=new I(c(t,r,n,o),a);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(R),u(R,i,"Generator"),R[a]=function(){return this},R.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=O,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(w),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return i.type="throw",i.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],i=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=e,s.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),w(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;w(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:O(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var v=function(e){return e&&e.Math==Math&&e},y=v("object"==typeof globalThis&&globalThis)||v("object"==typeof window&&window)||v("object"==typeof self&&self)||v("object"==typeof h&&h)||function(){return this}()||Function("return this")(),S=function(e){try{return!!e()}catch(e){return!0}},C=!S((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),E={}.propertyIsEnumerable,R=Object.getOwnPropertyDescriptor,b={f:R&&!E.call({1:2},1)?function(e){var t=R(this,e);return!!t&&t.enumerable}:E},I=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},T={}.toString,x=function(e){return T.call(e).slice(8,-1)},w="".split,_=S((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==x(e)?w.call(e,""):Object(e)}:Object,O=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},k=function(e){return _(O(e))},N=function(e){return"object"==typeof e?null!==e:"function"==typeof e},A=function(e,t){if(!N(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!N(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!N(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!N(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},M={}.hasOwnProperty,P=function(e,t){return M.call(e,t)},U=y.document,j=N(U)&&N(U.createElement),L=function(e){return j?U.createElement(e):{}},D=!C&&!S((function(){return 7!=Object.defineProperty(L("div"),"a",{get:function(){return 7}}).a})),G=Object.getOwnPropertyDescriptor,B={f:C?G:function(e,t){if(e=k(e),t=A(t,!0),D)try{return G(e,t)}catch(e){}if(P(e,t))return I(!b.f.call(e,t),e[t])}},F=function(e){if(!N(e))throw TypeError(String(e)+" is not an object");return e},V=Object.defineProperty,H={f:C?V:function(e,t,r){if(F(e),t=A(t,!0),F(r),D)try{return V(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},K=C?function(e,t,r){return H.f(e,t,I(1,r))}:function(e,t,r){return e[t]=r,e},q=function(e,t){try{K(y,e,t)}catch(r){y[e]=t}return t},W="__core-js_shared__",Y=y[W]||q(W,{}),X=Function.toString;"function"!=typeof Y.inspectSource&&(Y.inspectSource=function(e){return X.call(e)});var J,Q,z,Z=Y.inspectSource,$=y.WeakMap,ee="function"==typeof $&&/native code/.test(Z($)),te=m((function(e){(e.exports=function(e,t){return Y[e]||(Y[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.9.1",mode:"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})})),re=0,ne=Math.random(),oe=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++re+ne).toString(36)},ae=te("keys"),se=function(e){return ae[e]||(ae[e]=oe(e))},ie={},ue=y.WeakMap;if(ee){var ce=Y.state||(Y.state=new ue),fe=ce.get,de=ce.has,pe=ce.set;J=function(e,t){return t.facade=e,pe.call(ce,e,t),t},Q=function(e){return fe.call(ce,e)||{}},z=function(e){return de.call(ce,e)}}else{var le=se("state");ie[le]=!0,J=function(e,t){return t.facade=e,K(e,le,t),t},Q=function(e){return P(e,le)?e[le]:{}},z=function(e){return P(e,le)}}var ge,he,me={set:J,get:Q,has:z,enforce:function(e){return z(e)?Q(e):J(e,{})},getterFor:function(e){return function(t){var r;if(!N(t)||(r=Q(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},ve=m((function(e){var t=me.get,r=me.enforce,n=String(String).split("String");(e.exports=function(e,t,o,a){var s,i=!!a&&!!a.unsafe,u=!!a&&!!a.enumerable,c=!!a&&!!a.noTargetGet;"function"==typeof o&&("string"!=typeof t||P(o,"name")||K(o,"name",t),(s=r(o)).source||(s.source=n.join("string"==typeof t?t:""))),e!==y?(i?!c&&e[t]&&(u=!0):delete e[t],u?e[t]=o:K(e,t,o)):u?e[t]=o:q(t,o)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||Z(this)}))})),ye=y,Se=function(e){return"function"==typeof e?e:void 0},Ce=function(e,t){return arguments.length<2?Se(ye[e])||Se(y[e]):ye[e]&&ye[e][t]||y[e]&&y[e][t]},Ee=Math.ceil,Re=Math.floor,be=function(e){return isNaN(e=+e)?0:(e>0?Re:Ee)(e)},Ie=Math.min,Te=function(e){return e>0?Ie(be(e),9007199254740991):0},xe=Math.max,we=Math.min,_e=function(e){return function(t,r,n){var o,a=k(t),s=Te(a.length),i=function(e,t){var r=be(e);return r<0?xe(r+t,0):we(r,t)}(n,s);if(e&&r!=r){for(;s>i;)if((o=a[i++])!=o)return!0}else for(;s>i;i++)if((e||i in a)&&a[i]===r)return e||i||0;return!e&&-1}},Oe={includes:_e(!0),indexOf:_e(!1)},ke=Oe.indexOf,Ne=function(e,t){var r,n=k(e),o=0,a=[];for(r in n)!P(ie,r)&&P(n,r)&&a.push(r);for(;t.length>o;)P(n,r=t[o++])&&(~ke(a,r)||a.push(r));return a},Ae=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Me=Ae.concat("length","prototype"),Pe={f:Object.getOwnPropertyNames||function(e){return Ne(e,Me)}},Ue={f:Object.getOwnPropertySymbols},je=Ce("Reflect","ownKeys")||function(e){var t=Pe.f(F(e)),r=Ue.f;return r?t.concat(r(e)):t},Le=function(e,t){for(var r=je(t),n=H.f,o=B.f,a=0;a<r.length;a++){var s=r[a];P(e,s)||n(e,s,o(t,s))}},De=/#|\.prototype\./,Ge=function(e,t){var r=Fe[Be(e)];return r==He||r!=Ve&&("function"==typeof t?S(t):!!t)},Be=Ge.normalize=function(e){return String(e).replace(De,".").toLowerCase()},Fe=Ge.data={},Ve=Ge.NATIVE="N",He=Ge.POLYFILL="P",Ke=Ge,qe=B.f,We=function(e,t){var r,n,o,a,s,i=e.target,u=e.global,c=e.stat;if(r=u?y:c?y[i]||q(i,{}):(y[i]||{}).prototype)for(n in t){if(a=t[n],o=e.noTargetGet?(s=qe(r,n))&&s.value:r[n],!Ke(u?n:i+(c?".":"#")+n,e.forced)&&void 0!==o){if(typeof a==typeof o)continue;Le(a,o)}(e.sham||o&&o.sham)&&K(a,"sham",!0),ve(r,n,a,e)}},Ye=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Xe=function(e,t,r){if(Ye(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}},Je=function(e){return Object(O(e))},Qe=Array.isArray||function(e){return"Array"==x(e)},ze="process"==x(y.process),Ze=Ce("navigator","userAgent")||"",$e=y.process,et=$e&&$e.versions,rt=et&&et.v8;rt?he=(ge=rt.split("."))[0]+ge[1]:Ze&&(!(ge=Ze.match(/Edge\/(\d+)/))||ge[1]>=74)&&(ge=Ze.match(/Chrome\/(\d+)/))&&(he=ge[1]);var nt=he&&+he,ot=!!Object.getOwnPropertySymbols&&!S((function(){return!Symbol.sham&&(ze?38===nt:nt>37&&nt<41)})),at=ot&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,st=te("wks"),it=y.Symbol,ut=at?it:it&&it.withoutSetter||oe,ct=function(e){return P(st,e)&&(ot||"string"==typeof st[e])||(ot&&P(it,e)?st[e]=it[e]:st[e]=ut("Symbol."+e)),st[e]},ft=ct("species"),dt=function(e,t){var r;return Qe(e)&&("function"!=typeof(r=e.constructor)||r!==Array&&!Qe(r.prototype)?N(r)&&null===(r=r[ft])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===t?0:t)},pt=[].push,lt=function(e){var t=1==e,r=2==e,n=3==e,o=4==e,a=6==e,s=7==e,i=5==e||a;return function(u,c,f,d){for(var p,l,g=Je(u),h=_(g),m=Xe(c,f,3),v=Te(h.length),y=0,S=d||dt,C=t?S(u,v):r||s?S(u,0):void 0;v>y;y++)if((i||y in h)&&(l=m(p=h[y],y,g),e))if(t)C[y]=l;else if(l)switch(e){case 3:return!0;case 5:return p;case 6:return y;case 2:pt.call(C,p)}else switch(e){case 4:return!1;case 7:pt.call(C,p)}return a?-1:n||o?o:C}},gt={forEach:lt(0),map:lt(1),filter:lt(2),some:lt(3),every:lt(4),find:lt(5),findIndex:lt(6),filterOut:lt(7)},ht=ct("species"),mt=function(e){return nt>=51||!S((function(){var t=[];return(t.constructor={})[ht]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},vt=gt.map,yt=mt("map");We({target:"Array",proto:!0,forced:!yt},{map:function(e){return vt(this,e,arguments.length>1?arguments[1]:void 0)}});var St=y.Promise,Ct=H.f,Et=ct("toStringTag"),Rt=function(e,t,r){e&&!P(e=r?e:e.prototype,Et)&&Ct(e,Et,{configurable:!0,value:t})},bt=ct("species"),It={},Tt=ct("iterator"),xt=Array.prototype,wt={};wt[ct("toStringTag")]="z";var _t="[object z]"===String(wt),Ot=ct("toStringTag"),kt="Arguments"==x(function(){return arguments}()),Nt=_t?x:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Ot))?r:kt?x(t):"Object"==(n=x(t))&&"function"==typeof t.callee?"Arguments":n},At=ct("iterator"),Mt=function(e){var t=e.return;if(void 0!==t)return F(t.call(e)).value},Pt=function(e,t){this.stopped=e,this.result=t},Ut=function(e,t,r){var n,o,a,s,i,u,c,f,d=r&&r.that,p=!(!r||!r.AS_ENTRIES),l=!(!r||!r.IS_ITERATOR),g=!(!r||!r.INTERRUPTED),h=Xe(t,d,1+p+g),m=function(e){return n&&Mt(n),new Pt(!0,e)},v=function(e){return p?(F(e),g?h(e[0],e[1],m):h(e[0],e[1])):g?h(e,m):h(e)};if(l)n=e;else{if("function"!=typeof(o=function(e){if(null!=e)return e[At]||e["@@iterator"]||It[Nt(e)]}(e)))throw TypeError("Target is not iterable");if(void 0!==(f=o)&&(It.Array===f||xt[Tt]===f)){for(a=0,s=Te(e.length);s>a;a++)if((i=v(e[a]))&&i instanceof Pt)return i;return new Pt(!1)}n=o.call(e)}for(u=n.next;!(c=u.call(n)).done;){try{i=v(c.value)}catch(e){throw Mt(n),e}if("object"==typeof i&&i&&i instanceof Pt)return i}return new Pt(!1)},jt=ct("iterator"),Lt=!1;try{var Dt=0,Gt={next:function(){return{done:!!Dt++}},return:function(){Lt=!0}};Gt[jt]=function(){return this},Array.from(Gt,(function(){throw 2}))}catch(e){}var Bt,Ft,Vt,Ht=ct("species"),Kt=Ce("document","documentElement"),qt=/(iphone|ipod|ipad).*applewebkit/i.test(Ze),Wt=y.location,Yt=y.setImmediate,Xt=y.clearImmediate,Jt=y.process,Qt=y.MessageChannel,zt=y.Dispatch,Zt=0,$t={},er="onreadystatechange",tr=function(e){if($t.hasOwnProperty(e)){var t=$t[e];delete $t[e],t()}},rr=function(e){return function(){tr(e)}},nr=function(e){tr(e.data)},or=function(e){y.postMessage(e+"",Wt.protocol+"//"+Wt.host)};Yt&&Xt||(Yt=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return $t[++Zt]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Bt(Zt),Zt},Xt=function(e){delete $t[e]},ze?Bt=function(e){Jt.nextTick(rr(e))}:zt&&zt.now?Bt=function(e){zt.now(rr(e))}:Qt&&!qt?(Vt=(Ft=new Qt).port2,Ft.port1.onmessage=nr,Bt=Xe(Vt.postMessage,Vt,1)):y.addEventListener&&"function"==typeof postMessage&&!y.importScripts&&Wt&&"file:"!==Wt.protocol&&!S(or)?(Bt=or,y.addEventListener("message",nr,!1)):Bt=er in L("script")?function(e){Kt.appendChild(L("script")).onreadystatechange=function(){Kt.removeChild(this),tr(e)}}:function(e){setTimeout(rr(e),0)});var ar,sr,ir,ur,cr,fr,dr,pr,lr={set:Yt,clear:Xt},gr=/web0s(?!.*chrome)/i.test(Ze),hr=B.f,mr=lr.set,vr=y.MutationObserver||y.WebKitMutationObserver,yr=y.document,Sr=y.process,Cr=y.Promise,Er=hr(y,"queueMicrotask"),Rr=Er&&Er.value;Rr||(ar=function(){var e,t;for(ze&&(e=Sr.domain)&&e.exit();sr;){t=sr.fn,sr=sr.next;try{t()}catch(e){throw sr?ur():ir=void 0,e}}ir=void 0,e&&e.enter()},qt||ze||gr||!vr||!yr?Cr&&Cr.resolve?(dr=Cr.resolve(void 0),pr=dr.then,ur=function(){pr.call(dr,ar)}):ur=ze?function(){Sr.nextTick(ar)}:function(){mr.call(y,ar)}:(cr=!0,fr=yr.createTextNode(""),new vr(ar).observe(fr,{characterData:!0}),ur=function(){fr.data=cr=!cr}));var br,Ir,Tr,xr,wr=Rr||function(e){var t={fn:e,next:void 0};ir&&(ir.next=t),sr||(sr=t,ur()),ir=t},_r=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=Ye(t),this.reject=Ye(r)},Or={f:function(e){return new _r(e)}},kr=function(e,t){if(F(e),N(t)&&t.constructor===e)return t;var r=Or.f(e);return(0,r.resolve)(t),r.promise},Nr=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Ar=lr.set,Mr=ct("species"),Pr="Promise",Ur=me.get,jr=me.set,Lr=me.getterFor(Pr),Dr=St,Gr=y.TypeError,Br=y.document,Fr=y.process,Vr=Ce("fetch"),Hr=Or.f,Kr=Hr,qr=!!(Br&&Br.createEvent&&y.dispatchEvent),Wr="function"==typeof PromiseRejectionEvent,Yr="unhandledrejection",Xr=Ke(Pr,(function(){if(!(Z(Dr)!==String(Dr))){if(66===nt)return!0;if(!ze&&!Wr)return!0}if(nt>=51&&/native code/.test(Dr))return!1;var e=Dr.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[Mr]=t,!(e.then((function(){}))instanceof t)})),Jr=Xr||!function(e,t){if(!t&&!Lt)return!1;var r=!1;try{var n={};n[jt]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r}((function(e){Dr.all(e).catch((function(){}))})),Qr=function(e){var t;return!(!N(e)||"function"!=typeof(t=e.then))&&t},zr=function(e,t){if(!e.notified){e.notified=!0;var r=e.reactions;wr((function(){for(var n=e.value,o=1==e.state,a=0;r.length>a;){var s,i,u,c=r[a++],f=o?c.ok:c.fail,d=c.resolve,p=c.reject,l=c.domain;try{f?(o||(2===e.rejection&&tn(e),e.rejection=1),!0===f?s=n:(l&&l.enter(),s=f(n),l&&(l.exit(),u=!0)),s===c.promise?p(Gr("Promise-chain cycle")):(i=Qr(s))?i.call(s,d,p):d(s)):p(n)}catch(e){l&&!u&&l.exit(),p(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&$r(e)}))}},Zr=function(e,t,r){var n,o;qr?((n=Br.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),y.dispatchEvent(n)):n={promise:t,reason:r},!Wr&&(o=y["on"+e])?o(n):e===Yr&&function(e,t){var r=y.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}("Unhandled promise rejection",r)},$r=function(e){Ar.call(y,(function(){var t,r=e.facade,n=e.value;if(en(e)&&(t=Nr((function(){ze?Fr.emit("unhandledRejection",n,r):Zr(Yr,r,n)})),e.rejection=ze||en(e)?2:1,t.error))throw t.value}))},en=function(e){return 1!==e.rejection&&!e.parent},tn=function(e){Ar.call(y,(function(){var t=e.facade;ze?Fr.emit("rejectionHandled",t):Zr("rejectionhandled",t,e.value)}))},rn=function(e,t,r){return function(n){e(t,n,r)}},nn=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,zr(e,!0))},on=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw Gr("Promise can't be resolved itself");var n=Qr(t);n?wr((function(){var r={done:!1};try{n.call(t,rn(on,r,e),rn(nn,r,e))}catch(t){nn(r,t,e)}})):(e.value=t,e.state=1,zr(e,!1))}catch(t){nn({done:!1},t,e)}}};Xr&&(Dr=function(e){!function(e,t,r){if(!(e instanceof t))throw TypeError("Incorrect "+(r?r+" ":"")+"invocation")}(this,Dr,Pr),Ye(e),br.call(this);var t=Ur(this);try{e(rn(on,t),rn(nn,t))}catch(e){nn(t,e)}},(br=function(e){jr(this,{type:Pr,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=function(e,t,r){for(var n in t)ve(e,n,t[n],r);return e}(Dr.prototype,{then:function(e,t){var r,n,o,a=Lr(this),s=Hr((r=Dr,void 0===(o=F(this).constructor)||null==(n=F(o)[Ht])?r:Ye(n)));return s.ok="function"!=typeof e||e,s.fail="function"==typeof t&&t,s.domain=ze?Fr.domain:void 0,a.parent=!0,a.reactions.push(s),0!=a.state&&zr(a,!1),s.promise},catch:function(e){return this.then(void 0,e)}}),Ir=function(){var e=new br,t=Ur(e);this.promise=e,this.resolve=rn(on,t),this.reject=rn(nn,t)},Or.f=Hr=function(e){return e===Dr||e===Tr?new Ir(e):Kr(e)},"function"==typeof St&&(xr=St.prototype.then,ve(St.prototype,"then",(function(e,t){var r=this;return new Dr((function(e,t){xr.call(r,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof Vr&&We({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return kr(Dr,Vr.apply(y,arguments))}}))),We({global:!0,wrap:!0,forced:Xr},{Promise:Dr}),Rt(Dr,Pr,!1),function(e){var t=Ce(e),r=H.f;C&&t&&!t[bt]&&r(t,bt,{configurable:!0,get:function(){return this}})}(Pr),Tr=Ce(Pr),We({target:Pr,stat:!0,forced:Xr},{reject:function(e){var t=Hr(this);return t.reject.call(void 0,e),t.promise}}),We({target:Pr,stat:!0,forced:Xr},{resolve:function(e){return kr(this,e)}}),We({target:Pr,stat:!0,forced:Jr},{all:function(e){var t=this,r=Hr(t),n=r.resolve,o=r.reject,a=Nr((function(){var r=Ye(t.resolve),a=[],s=0,i=1;Ut(e,(function(e){var u=s++,c=!1;a.push(void 0),i++,r.call(t,e).then((function(e){c||(c=!0,a[u]=e,--i||n(a))}),o)})),--i||n(a)}));return a.error&&o(a.value),r.promise},race:function(e){var t=this,r=Hr(t),n=r.reject,o=Nr((function(){var o=Ye(t.resolve);Ut(e,(function(e){o.call(t,e).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}});var an=_t?{}.toString:function(){return"[object "+Nt(this)+"]"};_t||ve(Object.prototype,"toString",an,{unsafe:!0});var sn=function(e,t,r){var n=A(t);n in e?H.f(e,n,I(0,r)):e[n]=r},un=ct("isConcatSpreadable"),cn=9007199254740991,fn="Maximum allowed index exceeded",dn=nt>=51||!S((function(){var e=[];return e[un]=!1,e.concat()[0]!==e})),pn=mt("concat"),ln=function(e){if(!N(e))return!1;var t=e[un];return void 0!==t?!!t:Qe(e)};We({target:"Array",proto:!0,forced:!dn||!pn},{concat:function(e){var t,r,n,o,a,s=Je(this),i=dt(s,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(ln(a=-1===t?s:arguments[t])){if(u+(o=Te(a.length))>cn)throw TypeError(fn);for(r=0;r<o;r++,u++)r in a&&sn(i,u,a[r])}else{if(u>=cn)throw TypeError(fn);sn(i,u++,a)}return i.length=u,i}});var gn=new t.Logger("RCIM"),hn={TIMEOUT:{code:-1,msg:"Network timeout"},SDK_INTERNAL_ERROR:{code:-2,msg:"SDK internal error"},PARAMETER_ERROR:{code:-3,msg:"Please check the parameters, the {param} expected a value of {expect} but received {current}"},REJECTED_BY_BLACKLIST:{code:405,msg:"Blacklisted by the other party"},SEND_TOO_FAST:{code:20604,msg:"Sending messages too quickly"},NOT_IN_GROUP:{code:22406,msg:"Not in group"},FORBIDDEN_IN_GROUP:{code:22408,msg:"Forbbiden from speaking in the group"},NOT_IN_CHATROOM:{code:23406,msg:"Not in chatRoom"},FORBIDDEN_IN_CHATROOM:{code:23408,msg:"Forbbiden from speaking in the chatRoom"},KICKED_FROM_CHATROOM:{code:23409,msg:"Kicked out and forbbiden from joining the chatRoom"},CHATROOM_NOT_EXIST:{code:23410,msg:"ChatRoom does not exist"},CHATROOM_IS_FULL:{code:23411,msg:"ChatRoom members exceeded"},PARAMETER_INVALID_CHATROOM:{code:23412,msg:"Invalid chatRoom parameters"},ROAMING_SERVICE_UNAVAILABLE_CHATROOM:{code:23414,msg:"ChatRoom message roaming service is not open, Please go to the developer to open this service"},RECALLMESSAGE_PARAMETER_INVALID:{code:25101,msg:"Invalid recall message parameter"},ROAMING_SERVICE_UNAVAILABLE_MESSAGE:{code:25102,msg:"Single group chat roaming service is not open, Please go to the developer to open this service"},PUSHSETTING_PARAMETER_INVALID:{code:26001,msg:"Invalid push parameter"},OPERATION_BLOCKED:{code:20605,msg:"Operation is blocked"},OPERATION_NOT_SUPPORT:{code:20606,msg:"Operation is not supported"},MSG_BLOCKED_SENSITIVE_WORD:{code:21501,msg:"The sent message contains sensitive words"},REPLACED_SENSITIVE_WORD:{code:21502,msg:"Sensitive words in the message have been replaced"},NOT_CONNECTED:{code:30001,msg:"Please connect successfully first"},NAVI_REQUEST_ERROR:{code:30007,msg:"Navigation http request failed"},CMP_REQUEST_ERROR:{code:30010,msg:"CMP sniff http request failed"},CONN_APPKEY_FAKE:{code:31002,msg:"Your appkey is fake"},CONN_MINI_SERVICE_NOT_OPEN:{code:31003,msg:"Mini program service is not open, Please go to the developer to open this service"},CONN_ACK_TIMEOUT:{code:31e3,msg:"Connection ACK timeout"},CONN_TOKEN_INCORRECT:{code:31004,msg:"Your token is not valid or expired"},CONN_NOT_AUTHRORIZED:{code:31005,msg:"AppKey and Token do not match"},CONN_REDIRECTED:{code:31006,msg:"Connection redirection"},CONN_APP_BLOCKED_OR_DELETED:{code:31008,msg:"AppKey is banned or deleted"},CONN_USER_BLOCKED:{code:31009,msg:"User blocked"},CONN_DOMAIN_INCORRECT:{code:31012,msg:"Connect domain error, Please check the set security domain"},ROAMING_SERVICE_UNAVAILABLE:{code:33007,msg:"Roaming service cloud is not open, Please go to the developer to open this service"},RC_CONNECTION_EXIST:{code:34001,msg:"Connection already exists"},CHATROOM_KV_EXCEED:{code:23423,msg:"ChatRoom KV setting exceeds maximum"},CHATROOM_KV_OVERWRITE_INVALID:{code:23424,msg:"ChatRoom KV already exists"},CHATROOM_KV_STORE_NOT_OPEN:{code:23426,msg:"ChatRoom KV storage service is not open, Please go to the developer to open this service"},CHATROOM_KEY_NOT_EXIST:{code:23427,msg:"ChatRoom key does not exist"},MSG_KV_NOT_SUPPORT:{code:34008,msg:"The message cannot be extended"},SEND_MESSAGE_KV_FAIL:{code:34009,msg:"Sending RC expansion message fail"},EXPANSION_LIMIT_EXCEET:{code:34010,msg:"The message expansion size is beyond the limit"},ILLGAL_PARAMS:{code:33003,msg:"Incorrect parameters passed in while calling the interface"},CHATROOM_KV_STORE_NOT_ALL_SUCCESS:{code:23428,msg:"Chatroom kv store not all success"},CHATROOM_KV_STORE_OUT_LIMIT:{code:23429,msg:"chatroom kv's length is out of limit"}},mn={};for(var vn in hn){var yn=hn[vn].code;mn[yn]=vn}function Sn(e){var r=e.conversationType,n=e.messageType,o=e.content,a=e.senderUserId,s=e.targetId,i=e.sentTime,u=e.receivedTime,c=e.messageUId,f=e.messageDirection,d=e.isPersited,p=e.isCounted,l=e.isOffLineMessage,g=e.canIncludeExpansion,h=e.expansion,m=e.receivedStatus,v=e.disableNotification,y=e.isMentioned,S=e.isStatusMessage,C=e.readReceiptInfo;return m||(m=t.ReceivedStatus.UNREAD),{messageType:n,content:o,senderUserId:a,targetId:s,type:r,sentTime:i,receivedTime:u,messageUId:c,messageDirection:f,isPersited:d,isCounted:p,isOffLineMessage:l,isMentioned:y,disableNotification:v,isStatusMessage:S,canIncludeExpansion:g,expansion:h,receivedStatus:m,readReceiptInfo:C}}function Cn(e){var t=e.conversationType,r=e.targetId,n=e.latestMessage,o=e.unreadMessageCount,a=e.hasMentioned,s=e.mentionedInfo,i=e.lastUnreadTime,u=e.notificationStatus,c=e.isTop;return{type:t,targetId:r,latestMessage:n&&Sn(n),unreadMessageCount:o,hasMentioned:a,mentionedInfo:a?{type:null==s?void 0:s.type,userIdList:null==s?void 0:s.userIdList}:void 0,lastUnreadTime:i,notificationStatus:u,isTop:c}}function En(e){t.assert("options.messageType",e.messageType,t.AssertRules.STRING,!0),t.assert("options.content",e.content,(function(e){return t.isObject(e)}),!0),t.assert("options.isPersited",e.isPersited,t.AssertRules.BOOLEAN),t.assert("options.isCounted",e.isCounted,t.AssertRules.BOOLEAN),t.assert("options.pushContent",e.pushContent,t.AssertRules.STRING),t.assert("options.pushData",e.pushData,t.AssertRules.STRING),t.assert("options.isVoipPush",e.isVoipPush,t.AssertRules.BOOLEAN),t.assert("options.isStatusMessage",e.isStatusMessage,t.AssertRules.BOOLEAN),t.assert("options.isMentioned",e.isMentioned,t.AssertRules.BOOLEAN),t.assert("options.mentionedType",e.mentionedType,t.AssertRules.NUMBER),t.assert("options.mentionedUserIdList",e.mentionedUserIdList,(function(e){return t.isArray(e)&&(0===e.length||e.every(t.isString))})),t.assert("options.directionalUserIdList",e.directionalUserIdList,(function(e){return t.isArray(e)&&(0===e.length||e.every(t.isString))})),t.isUndefined(e.isPersited)&&t.isUndefined(e.isCounted)&&t.isUndefined(e.isStatusMessage)||gn.warn("The parameters `isPersited`, `isCounted`, `isStatusMessage` will be deprecated in future releases due to inconsistance of the values on mobile side and web side. Please use `registerMessageType` instead for non-integrated message type.")}var Rn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},bn=function(e,t){var r=[][e];return!!r&&S((function(){r.call(null,t||function(){throw 1},1)}))},In=gt.forEach,Tn=bn("forEach")?[].forEach:function(e){return In(this,e,arguments.length>1?arguments[1]:void 0)};for(var xn in Rn){var wn=y[xn],_n=wn&&wn.prototype;if(_n&&_n.forEach!==Tn)try{K(_n,"forEach",Tn)}catch(e){_n.forEach=Tn}}var On=[].join,kn=_!=Object,Nn=bn("join",",");We({target:"Array",proto:!0,forced:kn||!Nn},{join:function(e){return On.call(k(this),void 0===e?",":e)}});var An,Mn=function(e,t){if(!e)return[];var r=Pn(e),n=jn(r.topConversationList,t),o=jn(r.unToppedConversationList,t);return n.push.apply(n,o),n},Pn=function(e){var r=[],n=[];return t.forEach(e,(function(e){var t=e.hasMentioned,o=e.mentionedInfo;e.hasMentioned=t,e.mentionedInfo=o,e.isTop||!1?r.push(e):n.push(e)})),{topConversationList:r||[],unToppedConversationList:n||[]}},Un=function(e){return e.type+"_"+e.targetId},jn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Dn(e,(function(e,r){r=r||{};var n=(e=e||{}).latestMessage||{},o=r.latestMessage||{},a=n.sentTime||0,s=o.sentTime||0;return t?s>=a:s<=a}))},Ln=function(e){var r=e=e||{},n=r.targetId,o=r.type,a=t.ConversationType.PRIVATE,s={messageType:t.MessageType.TextMessage,sentTime:t.DelayTimer.getTime(),content:{content:""},senderUserId:n,targetId:n,type:o};return e.type=o||a,e.targetId=n||"",e.latestMessage=e.latestMessage||s,e},Dn=function(e,t){return function e(t,r,n,o){if(o=o||function(e,t){return e<=t},r<n){for(var a,s=t[n],i=r-1,u=r;u<=n;u++)o(t[u],s)&&(a=t[++i],t[i]=t[u],t[u]=a);e(t,r,i-1,o),e(t,i+1,n,o)}return t}(e,0,e.length-1,t)},Gn=function(e){return!e.type||!e.targetId||!t.isObject(e.latestMessage)||t.isUndefined(e.unreadMessageCount)},Bn=function(e,r,n){var o=(n=n||{}).isAllowNull;for(var a in e=e||{},r=r||{}){var s=r[a];t.isUndefined(s)&&!o||(e[a]=s)}return e},Fn=function(){function e(t,r){a(this,e),this._context=t,this.targetId=r.targetId,this.type=r.type}var r,n,s,u,c,f,d,p,l,h,m,v,y,S,C,E,R,b,I,T;return i(e,[{key:"destory",value:(T=o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.removeConversation(this.type,this.targetId);case 2:if(r=e.sent,n="type:"+this.type+",targetId:"+this.targetId,gn.debug("destroy conversation ->"+n),r===t.ErrorCode.SUCCESS){e.next=8;break}return gn.warn("destroy conversation fail ->"+r+":"+mn[r]+","+n),e.abrupt("return",Promise.reject({code:r,msg:mn[r]}));case 8:case"end":return e.stop()}}),e,this)}))),function(){return T.apply(this,arguments)})},{key:"read",value:(I=o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.clearUnreadCount(this.type,this.targetId);case 2:if(r=e.sent,n="type:"+this.type+",targetId:"+this.targetId,gn.debug("clear unreadMsgNum ->"+n),r===t.ErrorCode.SUCCESS){e.next=8;break}return gn.warn("clear unreadMsgNum fail ->"+r+":"+mn[r]+","+n),e.abrupt("return",Promise.reject({code:r,msg:mn[r]}));case 8:case"end":return e.stop()}}),e,this)}))),function(){return I.apply(this,arguments)})},{key:"getUnreadCount",value:(b=o(regeneratorRuntime.mark((function e(){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.getUnreadCount(this.type,this.targetId);case 2:if(r=e.sent,n=r.code,o=r.data,a="type:"+this.type+",targetId:"+this.targetId,gn.debug("get unreadCount ->"+a),n!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",o);case 9:return gn.warn("get unreadCount fail ->"+n+":"+mn[n]+","+a),e.abrupt("return",Promise.reject({code:n,msg:mn[n]}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"send",value:(R=o(regeneratorRuntime.mark((function e(r){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return En(r),Object.prototype.hasOwnProperty.call(r,"isPersited")||(r.isPersited=!0),Object.prototype.hasOwnProperty.call(r,"isCounted")||(r.isCounted=!0),n="type:"+this.type+",targetId:"+this.targetId,gn.debug("send message  ->"+n),e.next=7,this._context.sendMessage(this.type,this.targetId,r);case 7:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS){e.next=12;break}return e.abrupt("return",Sn(s));case 12:return gn.warn("send message fail ->"+a+":"+mn[a]+","+n),e.abrupt("return",Promise.reject({code:a,msg:mn[a],data:Sn({isMentioned:!!r.isMentioned,content:r.content,messageType:r.messageType,isPersited:r.isPersited||!1,isCounted:r.isCounted||!1,disableNotification:!(null==r||!r.disableNotification),canIncludeExpansion:!(null==r||!r.canIncludeExpansion),expansion:(null==r?void 0:r.expansion)||null,conversationType:this.type,targetId:this.targetId,senderUserId:this._context.getCurrentUserId(),messageUId:"",messageDirection:t.MessageDirection.SEND,isOffLineMessage:!1,sentTime:(null==s?void 0:s.sentTime)||0,receivedTime:0,isStatusMessage:r.isStatusMessage||!1,receivedStatus:t.ReceivedStatus.UNREAD})}));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return R.apply(this,arguments)})},{key:"setStatus",value:(E=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.notificationStatus",r.notificationStatus,(function(e){return 1===e||2===e})),t.assert("options.isTop",r.isTop,t.AssertRules.BOOLEAN),n="type:"+this.type+",targetId:"+this.targetId,gn.debug("set conversation status ->"+n),e.next=6,this._context.setConversationStatus(this.type,this.targetId,r.isTop,r.notificationStatus);case 6:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=10;break}return gn.warn("set conversation status fail ->"+o+":"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"getMessages",value:(C=o(regeneratorRuntime.mark((function e(r){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.timestamp",r.timestamp,t.AssertRules.NUMBER),t.assert("options.count",r.count,t.AssertRules.NUMBER),t.assert("options.order",r.order,(function(e){return 0===e||1===e})),n="type:"+this.type+",targetId:"+this.targetId,gn.debug("get history message ->"+n),e.next=7,this._context.getHistoryMessage(this.type,this.targetId,null==r?void 0:r.timestamp,null==r?void 0:r.count,null==r?void 0:r.order);case 7:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS||!s){e.next=13;break}return i=s.list.map((function(e){return Sn(e)})),e.abrupt("return",Promise.resolve({list:i,hasMore:s.hasMore}));case 13:return gn.warn("get history message fail ->"+a+":"+mn[a]+","+n),e.abrupt("return",Promise.reject({code:a,msg:mn[a]}));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"recall",value:(S=o(regeneratorRuntime.mark((function e(r){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.messageUId",r.messageUId,t.AssertRules.STRING,!0),t.assert("options.sentTime",r.sentTime,t.AssertRules.NUMBER,!0),t.assert("options.disableNotification",null==r?void 0:r.disableNotification,t.AssertRules.BOOLEAN),t.assert("options.pushConfig",null==r?void 0:r.pushConfig,t.AssertRules.OBJECT),n={user:r.user,channelId:"",disableNotification:null==r?void 0:r.disableNotification,pushConfig:null==r?void 0:r.pushConfig},o="type:"+this.type+",targetId:"+this.targetId+",messageUId:"+r.messageUId,gn.debug("recall message ->"+o),e.next=9,this._context.recallMessage(this.type,this.targetId,r.messageUId,r.sentTime,n);case 9:if(a=e.sent,s=a.code,i=a.data,s!==t.ErrorCode.SUCCESS||!i){e.next=14;break}return e.abrupt("return",Sn(i));case 14:return gn.warn("recall message fail ->"+s+":"+mn[s]+","+o),e.abrupt("return",Promise.reject({code:s,msg:mn[s]}));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"deleteMessages",value:(y=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options",r,(function(e){return t.isArray(e)&&e.length}),!0),r.forEach((function(e){t.assert("options.messageUId",e.messageUId,t.AssertRules.STRING,!0),t.assert("options.sentTime",e.sentTime,t.AssertRules.NUMBER,!0),t.assert("options.messageDirection",e.messageDirection,(function(e){return 1===e||2===e}),!0)})),n="type:"+this.type+",targetId:"+this.targetId,gn.debug("delete messages ->"+n),e.next=6,this._context.deleteRemoteMessage(this.type,this.targetId,r);case 6:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=10;break}return gn.warn("delete message fail ->"+o+":"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"clearMessages",value:(v=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.timestamp",r.timestamp,t.AssertRules.NUMBER,!0),n="type:"+this.type+",targetId:"+this.targetId,gn.debug("clear message ->"+n),e.next=5,this._context.deleteRemoteMessageByTimestamp(this.type,this.targetId,r.timestamp);case 5:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=9;break}return gn.warn("clear message ->"+o+":"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"updateMessageExpansion",value:(m=o(regeneratorRuntime.mark((function e(r,n){var o,a,s,i,u,c,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("expansion",r,t.AssertRules.OBJECT,!0),t.assert("message",n,t.AssertRules.OBJECT,!0),o=n.type,a=n.targetId,s=n.messageUId,i=n.canIncludeExpansion,u=n.expansion,c="type:"+o+",targetId:"+this.targetId+",messageUId:"+s,gn.debug("update message expansion ->"+c),e.next=7,this._context.sendExpansionMessage({conversationType:o,targetId:a,messageUId:s,expansion:r,canIncludeExpansion:i,originExpansion:u,channelId:""});case 7:if(f=e.sent,(d=f.code)===t.ErrorCode.SUCCESS){e.next=12;break}return gn.warn("update message expansion fail ->"+d+":"+mn[d]+","+c),e.abrupt("return",Promise.reject({code:d,msg:mn[d]}));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return m.apply(this,arguments)})},{key:"removeMessageExpansion",value:(h=o(regeneratorRuntime.mark((function e(r,n){var o,a,s,i,u,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("keys",r,t.AssertRules.ARRAY,!0),t.assert("message",n,t.AssertRules.OBJECT,!0),o=n.type,a=n.targetId,s=n.messageUId,i=n.canIncludeExpansion,u="type:"+o+",targetId:"+this.targetId+",messageUId:"+s,gn.debug("remove message expansion ->"+u),e.next=7,this._context.sendExpansionMessage({conversationType:o,targetId:a,messageUId:s,canIncludeExpansion:i,keys:r,channelId:""});case 7:if(c=e.sent,(f=c.code)===t.ErrorCode.SUCCESS){e.next=12;break}return gn.warn("remove message expansion fail ->"+f+":"+mn[f]+","+u),e.abrupt("return",Promise.reject({code:f,msg:mn[f]}));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return h.apply(this,arguments)})},{key:"setDraft",value:(l=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("draft",r,t.AssertRules.STRING,!0),n="type:"+this.type+",targetId:"+this.targetId,gn.debug("set draft ->"+n),e.next=5,this._context.saveConversationMessageDraft(this.type,this.targetId,r);case 5:if((o=e.sent)!==t.ErrorCode.SUCCESS){e.next=8;break}return e.abrupt("return",Promise.resolve());case 8:gn.warn("set draft fail ->"+o+":"+mn[o]+","+n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getDraft",value:(p=o(regeneratorRuntime.mark((function e(){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.getConversationMessageDraft(this.type,this.targetId);case 2:if(r=e.sent,n=r.code,o=r.data,a="type:"+this.type+",targetId:"+this.targetId,gn.debug("get draft ->"+a),n!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",Promise.resolve(o));case 9:return gn.warn("get draft fail ->"+n+":"+mn[n]+","+a),e.abrupt("return",Promise.reject({code:n,msg:mn[n]}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"deleteDraft",value:(d=o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="type:"+this.type+",targetId:"+this.targetId,gn.debug("delete draft  ->"+r),e.next=4,this._context.clearConversationMessageDraft(this.type,this.targetId);case 4:if((n=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",Promise.resolve());case 7:gn.warn("delete draft fail ->"+n+":"+mn[n]+","+r);case 8:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"sendReadReceiptMessage",value:(f=o(regeneratorRuntime.mark((function e(r){var n,o,a,s,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.assert("messageUIds",r,t.AssertRules.ARRAY,!0),n=g(r);try{for(n.s();!(o=n.n()).done;)a=o.value,t.assert("messageUId",a,t.AssertRules.STRING)}catch(e){n.e(e)}finally{n.f()}return s="messageUIds:"+r.join(",")+",targetId:"+this.targetId,gn.debug("send read receipt message ->"+s),e.next=7,this._context.sendReadReceiptMessage(this.targetId,r);case 7:if(i=e.sent,(u=i.code)!==t.ErrorCode.SUCCESS){e.next=11;break}return e.abrupt("return",Promise.resolve());case 11:return gn.warn("send read receipt message fail ->"+u+":"+mn[u]+","+s),e.abrupt("return",Promise.reject(u));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"sendTypingStatusMessage",value:(c=o(regeneratorRuntime.mark((function e(r){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("typingContentType",r,t.AssertRules.STRING,!0),n="type:"+this.type+",targetId:"+this.targetId,gn.debug("send typing status message ->"+n),o={messageType:"RC:TypSts",content:{typingContentType:r},isStatusMessage:!0,channelId:""},e.next=6,this._context.sendMessage(this.type,this.targetId,o);case 6:if(a=e.sent,s=a.code,i=a.data,s!==t.ErrorCode.SUCCESS){e.next=11;break}return e.abrupt("return",Sn(i));case 11:return gn.warn("send typing status message fail ->"+s+":"+mn[s]+","+n),e.abrupt("return",Promise.reject({code:s,msg:mn[s]}));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getMessageReader",value:(u=o(regeneratorRuntime.mark((function e(r){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("messageUId",r,t.AssertRules.STRING,!0),n="messageUId:"+r+",targetId:"+this.targetId,gn.debug("get message reader ->"+n),e.next=5,this._context.getMessageReader(this.targetId,r);case 5:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS){e.next=10;break}return e.abrupt("return",Promise.resolve(s));case 10:return gn.warn("get message reader fail ->"+a+":"+mn[a]+","+n),e.abrupt("return",Promise.reject(a));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getInfo",value:(s=o(regeneratorRuntime.mark((function e(){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.getConversation(this.type,this.targetId,"");case 2:if(r=e.sent,n=r.code,o=r.data,n!==t.ErrorCode.SUCCESS||!o){e.next=7;break}return e.abrupt("return",Cn(o));case 7:return e.abrupt("return",Promise.reject({code:n,msg:mn[n]}));case 8:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"removeTags",value:(n=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("tagIds",r,t.AssertRules.ARRAY,!0),r.forEach((function(e){t.assert("tagId",e,t.AssertRules.STRING,!0)})),gn.info("removeTags ->targetId:"+this.targetId+",type:"+this.type),e.next=5,this._context.removeTagsForConversation({type:this.type,targetId:this.targetId},r);case 5:if(n=e.sent,(o=n.code)!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",o);case 9:return gn.warn("removeTags fail ->"+o+":"+mn[o]),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getTags",value:(r=o(regeneratorRuntime.mark((function e(){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gn.info("getTags ->targetId:"+this.targetId+",type:"+this.type),e.next=3,this._context.getTagsForConversation({type:this.type,targetId:this.targetId});case 3:if(r=e.sent,n=r.code,o=r.data,n!==t.ErrorCode.SUCCESS){e.next=8;break}return e.abrupt("return",o||[]);case 8:return gn.warn("getTags fail ->"+n+":"+mn[n]),e.abrupt("return",Promise.reject({code:n,msg:mn[n]}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}]),e}(),Vn=function(){function e(t){a(this,e),this._context=t}var r,n;return i(e,[{key:"getList",value:(n=o(regeneratorRuntime.mark((function e(r){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gn.debug("get conversation list ->"),e.next=3,this._context.getConversationList(null==r?void 0:r.count,void 0,null==r?void 0:r.startTime,null==r?void 0:r.order);case 3:if(n=e.sent,o=n.code,a=n.data,o!==t.ErrorCode.SUCCESS||!a){e.next=9;break}return s=a.map((function(e){return Cn(e)})),e.abrupt("return",Mn(s));case 9:return gn.warn("get conversation list fail ->"+o+":"+mn[o]),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"get",value:function(e){return t.assert("options.type",e.type,t.isValidConversationType,!0),new Fn(this._context,e)}},{key:"remove",value:function(e){return t.assert("options.type",e.type,t.isValidConversationType,!0),new Fn(this._context,e).destory()}},{key:"getTotalUnreadCount",value:(r=o(regeneratorRuntime.mark((function e(r,n){var o,a,s,i,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(gn.debug("get total unread count -> ConversationType:"+JSON.stringify(n)+" includeMuted:"+r),t.assert("includeMuted",r,t.AssertRules.BOOLEAN,!1),t.assert("conversationTypes",n,t.AssertRules.ARRAY,!1),n){o=g(n);try{for(o.s();!(a=o.n()).done;)s=a.value,t.assert("conversationType",s,t.AssertRules.NUMBER)}catch(e){o.e(e)}finally{o.f()}}return e.next=6,this._context.getTotalUnreadCount("",n,r);case 6:if(i=e.sent,u=i.code,c=i.data,u!==t.ErrorCode.SUCCESS){e.next=11;break}return e.abrupt("return",c);case 11:return gn.warn("getTotalUnreadCount fail ->"+u+":"+mn[u]),e.abrupt("return",Promise.reject({code:u,msg:mn[u]}));case 13:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"merge",value:function(e){return!e.conversationList&&gn.warn("Parameter option.conversationList are required!"),function(e){var r=e=e||{},n=r.conversationList,o=r.updatedConversationList;n=n||[];var a=[].concat(d(o=o||[]),d(n)),s={},i=[],u=[];return t.forEach(a,(function(e){if(t.isObject(e)){var r=e,n=r.type,o=r.targetId,a=Un({type:n,targetId:o}),c=s[a]||{},f=t.isUndefined(c.index)?i.length:c.index,d=c.val||{},p=d.updatedItems||{},l=e.updatedItems;e=Bn(e,d),t.forEach(p,(function(t,r){e[r]=t.val})),t.forEach(l,(function(t,r){var n=(p[r]||{}).time||0;t.time>n&&(e[r]=t.val)})),s[a]={index:f,val:e},i[f]=e,Gn(e)&&u.push(f)}})),t.forEach(u,(function(e){var t=i[e];i[e]=Ln(t)})),i=Mn(i),t.map(i,(function(e){return delete e.updatedItems,e}))}(e)}}]),e}(),Hn=function(){function e(t,r){a(this,e),this._context=t,this.tagId=r}var r,n,s,u,c,f,d;return i(e,[{key:"update",value:(d=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("tagName",r,t.AssertRules.STRING,!0),t.assert("tagName",r,(function(e){return e.length<=15})),gn.info("update ->tagId:"+this.tagId+",tagName:"+r),e.next=5,this._context.updateTag({tagId:this.tagId,tagName:r});case 5:if(n=e.sent,(o=n.code)!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",o);case 9:return gn.warn("update ->code:"+o+",tagId:"+this.tagId),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"remove",value:(f=o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gn.info("remove ->tagId:"+this.tagId),e.next=3,this._context.removeTag(this.tagId);case 3:if(r=e.sent,(n=r.code)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",n);case 7:return gn.warn("remove ->code:"+n+",tagId:"+this.tagId),e.abrupt("return",Promise.reject({code:n,msg:mn[n]}));case 9:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"addConversations",value:(c=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("conversations",r,t.AssertRules.ARRAY,!0),r.forEach((function(e){t.assert("conversation.type",e.type,t.AssertRules.NUMBER,!0),t.assert("conversation.targetId",e.targetId,t.AssertRules.STRING,!0)})),gn.info("addConversations ->tagId:"+this.tagId),e.next=5,this._context.addTagForConversations(this.tagId,r);case 5:if(n=e.sent,(o=n.code)!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",o);case 9:return gn.warn("addConversations ->code:"+o+",tagId:"+this.tagId),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"removeConversations",value:(u=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gn.info("removeConversations ->tagId:"+this.tagId),e.next=3,this._context.removeTagForConversations(this.tagId,r);case 3:if(n=e.sent,(o=n.code)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",o);case 7:return gn.warn("removeConversations ->code:"+o+",tagId:"+this.tagId),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"getConversationList",value:(s=o(regeneratorRuntime.mark((function e(r,n){var o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("count",n,t.AssertRules.NUMBER,!0),t.assert("startTime",r,t.AssertRules.NUMBER,!0),gn.info("getConversationList ->tagId:"+this.tagId),e.next=5,this._context.getConversationListByTag(this.tagId,r,n);case 5:if(o=e.sent,a=o.data,s=o.code,i=[],s!==t.ErrorCode.SUCCESS){e.next=13;break}return(a=a||[]).forEach((function(e){var t=e.channelId,r=e.conversationType,n=e.targetId,o=e.unreadMessageCount,a=e.latestMessage,s=e.hasMentioned,u=e.mentionedInfo,c=e.notificationStatus,f=e.isTop,d=e.lastUnreadTime,p=e.isTopInTag;i.push({channelId:t,conversationType:r,targetId:n,unreadMessageCount:o,latestMessage:a,hasMentioned:s,mentionedInfo:u,notificationStatus:c,isTop:f,lastUnreadTime:d,isTopInTag:p})})),e.abrupt("return",i);case 13:return gn.warn("getConversationList ->code:"+s+",tagId:"+this.tagId),e.abrupt("return",Promise.reject({code:s,msg:mn[s]}));case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"getUnreadCount",value:(n=o(regeneratorRuntime.mark((function e(r){var n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("isIncludeNotNotification",r,t.AssertRules.BOOLEAN,!0),gn.info("getUnreadCount ->tagId:"+this.tagId),e.next=4,this._context.getUnreadCountByTag(this.tagId,r);case 4:if(n=e.sent,o=n.data,(a=n.code)!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",o||0);case 9:return gn.warn("getUnreadCount ->code:"+a+",tagId:"+this.tagId),e.abrupt("return",Promise.reject({code:a,msg:mn[a]}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateConversationIsTop",value:(r=o(regeneratorRuntime.mark((function e(r,n){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("conversation.targetId",r.targetId,t.AssertRules.STRING,!0),t.assert("conversation.type",r.type,t.AssertRules.NUMBER,!0),t.assert("isTop",n,t.AssertRules.BOOLEAN,!0),gn.info("updateConversationIsTop ->tagId:"+this.tagId),e.next=6,this._context.setConversationStatusInTag(this.tagId,r,{isTop:n});case 6:if(o=e.sent,(a=o.code)!==t.ErrorCode.SUCCESS){e.next=10;break}return e.abrupt("return",a);case 10:return gn.warn("updateConversationIsTop ->code:"+a+",tagId:"+this.tagId),e.abrupt("return",Promise.reject({code:a,msg:mn[a]}));case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})}]),e}(),Kn=function(){function e(t){a(this,e),this._context=t}var r,n,s;return i(e,[{key:"create",value:(s=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("tag.tagId",r.tagId,t.AssertRules.STRING,!0),t.assert("tag.tagId",r.tagId,(function(e){return e.length<=10})),t.assert("tag.tagName",r.tagName,(function(e){return e.length<=15})),t.assert("tag.tagName",r.tagName,t.AssertRules.STRING,!0),gn.info("create tag->tagId:"+r.tagId+",tagName:"+r.tagName),e.next=7,this._context.createTag(r);case 7:if(n=e.sent,(o=n.code)!==t.ErrorCode.SUCCESS){e.next=11;break}return e.abrupt("return",o);case 11:return gn.warn("create tag fail ->"+o+":"+mn[o]),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getTagInfoList",value:(n=o(regeneratorRuntime.mark((function e(){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.getTagList();case 2:if(r=e.sent,n=r.code,o=r.data,n!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",o||[]);case 7:return gn.warn("getTagInfoList ->code:"+n),e.abrupt("return",Promise.reject({code:n,msg:mn[n]}));case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"get",value:(r=o(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("tag.tagId",r,t.AssertRules.STRING,!0),t.assert("tag.tagId",r,(function(e){return e.length<=10})),e.abrupt("return",new Hn(this._context,r));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),e}(),qn=Object.keys||function(e){return Ne(e,Ae)},Wn=C?Object.defineProperties:function(e,t){F(e);for(var r,n=qn(t),o=n.length,a=0;o>a;)H.f(e,r=n[a++],t[r]);return e},Yn=se("IE_PROTO"),Xn=function(){},Jn=function(e){return"<script>"+e+"</"+"script>"},Qn=function(){try{An=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;Qn=An?function(e){e.write(Jn("")),e.close();var t=e.parentWindow.Object;return e=null,t}(An):((t=L("iframe")).style.display="none",Kt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Jn("document.F=Object")),e.close(),e.F);for(var r=Ae.length;r--;)delete Qn.prototype[Ae[r]];return Qn()};ie[Yn]=!0;var zn=Object.create||function(e,t){var r;return null!==e?(Xn.prototype=F(e),r=new Xn,Xn.prototype=null,r[Yn]=e):r=Qn(),void 0===t?r:Wn(r,t)},Zn=ct("unscopables"),$n=Array.prototype;null==$n[Zn]&&H.f($n,Zn,{configurable:!0,value:zn(null)});var eo,to,ro,no=function(e){$n[Zn][e]=!0},oo=!S((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),ao=se("IE_PROTO"),so=Object.prototype,io=oo?Object.getPrototypeOf:function(e){return e=Je(e),P(e,ao)?e[ao]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?so:null},uo=ct("iterator"),co=!1;[].keys&&("next"in(ro=[].keys())?(to=io(io(ro)))!==Object.prototype&&(eo=to):co=!0),(null==eo||S((function(){var e={};return eo[uo].call(e)!==e})))&&(eo={}),P(eo,uo)||K(eo,uo,(function(){return this}));var fo={IteratorPrototype:eo,BUGGY_SAFARI_ITERATORS:co},po=fo.IteratorPrototype,lo=function(){return this},go=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return F(r),function(e){if(!N(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(n),t?e.call(r,n):r.__proto__=n,r}}():void 0),ho=fo.IteratorPrototype,mo=fo.BUGGY_SAFARI_ITERATORS,vo=ct("iterator"),yo="keys",So="values",Co="entries",Eo=function(){return this},Ro="Array Iterator",bo=me.set,Io=me.getterFor(Ro),To=function(e,t,r,n,o,a,s){!function(e,t,r){var n=t+" Iterator";e.prototype=zn(po,{next:I(1,r)}),Rt(e,n,!1),It[n]=lo}(r,t,n);var i,u,c,f=function(e){if(e===o&&h)return h;if(!mo&&e in l)return l[e];switch(e){case yo:case So:case Co:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",p=!1,l=e.prototype,g=l[vo]||l["@@iterator"]||o&&l[o],h=!mo&&g||f(o),m="Array"==t&&l.entries||g;if(m&&(i=io(m.call(new e)),ho!==Object.prototype&&i.next&&(io(i)!==ho&&(go?go(i,ho):"function"!=typeof i[vo]&&K(i,vo,Eo)),Rt(i,d,!0))),o==So&&g&&g.name!==So&&(p=!0,h=function(){return g.call(this)}),l[vo]!==h&&K(l,vo,h),It[t]=h,o)if(u={values:f(So),keys:a?h:f(yo),entries:f(Co)},s)for(c in u)(mo||p||!(c in l))&&ve(l,c,u[c]);else We({target:t,proto:!0,forced:mo||p},u);return u}(Array,"Array",(function(e,t){bo(this,{type:Ro,target:k(e),index:0,kind:t})}),(function(){var e=Io(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");It.Arguments=It.Array,no("keys"),no("values"),no("entries");var xo=ct("iterator"),wo=ct("toStringTag"),_o=To.values;for(var Oo in Rn){var ko=y[Oo],No=ko&&ko.prototype;if(No){if(No[xo]!==_o)try{K(No,xo,_o)}catch(e){No[xo]=_o}if(No[wo]||K(No,wo,Oo),Rn[Oo])for(var Ao in To)if(No[Ao]!==To[Ao])try{K(No,Ao,To[Ao])}catch(e){No[Ao]=To[Ao]}}}var Mo=Oe.includes;We({target:"Array",proto:!0},{includes:function(e){return Mo(this,e,arguments.length>1?arguments[1]:void 0)}}),no("includes");var Po=Object.assign,Uo=Object.defineProperty,jo=!Po||S((function(){if(C&&1!==Po({b:1},Po(Uo({},"a",{enumerable:!0,get:function(){Uo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=Po({},e)[r]||qn(Po({},t)).join("")!=n}))?function(e,t){for(var r=Je(e),n=arguments.length,o=1,a=Ue.f,s=b.f;n>o;)for(var i,u=_(arguments[o++]),c=a?qn(u).concat(a(u)):qn(u),f=c.length,d=0;f>d;)i=c[d++],C&&!s.call(u,i)||(r[i]=u[i]);return r}:Po;We({target:"Object",stat:!0,forced:Object.assign!==jo},{assign:jo});var Lo=function(e){t.assert("options.key",e.key,t.AssertRules.STRING,!0),t.assert("options.value",e.value,t.AssertRules.STRING,!0),t.assert("options.isAutoDelete",e.isAutoDelete,t.AssertRules.BOOLEAN),t.assert("options.isSendNotification",e.isSendNotification,t.AssertRules.BOOLEAN),t.assert("options.notificationExtra",e.notificationExtra,t.AssertRules.STRING)},Do=function(e){e.entries.forEach((function(e){t.assert("entry.key",e.key,t.AssertRules.STRING,!0),t.assert("entry.value",e.value,t.AssertRules.STRING,!0)})),t.assert("options.isAutoDelete",e.isAutoDelete,t.AssertRules.BOOLEAN),t.assert("options.notificationExtra",e.notificationExtra,t.AssertRules.STRING)},Go=function(e){t.assert("options.key",e.key,t.AssertRules.STRING,!0),t.assert("options.isSendNotification",e.isSendNotification,t.AssertRules.BOOLEAN),t.assert("options.notificationExtra",e.notificationExtra,t.AssertRules.STRING)},Bo=function(e){e.entries.forEach((function(e){t.assert("key",e,t.AssertRules.STRING,!0)}))},Fo=function(){function e(t,r){a(this,e),this._context=t,this._id=r}var r,n,s,u,c,f,d,p,l,g,h,m,v,y,S;return i(e,[{key:"join",value:(S=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.count",r.count,t.AssertRules.NUMBER,!0),n="id:"+this._id,gn.debug("join chatroom ->"+n),e.next=5,this._context.joinChatroom(this._id,r.count);case 5:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=9;break}return gn.warn("join chatroom fail ->code+:"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return S.apply(this,arguments)})},{key:"joinExist",value:(y=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.count",r.count,t.AssertRules.NUMBER,!0),n="id:"+this._id,gn.debug("join exist chatroom ->"+n),e.next=5,this._context.joinExistChatroom(this._id,r.count);case 5:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=9;break}return gn.warn("join exist chatroom fail ->code:"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"quit",value:(v=o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="id:"+this._id,gn.debug("quit chatroom ->"+r),e.next=4,this._context.quitChatroom(this._id);case 4:if((n=e.sent)===t.ErrorCode.SUCCESS){e.next=8;break}return gn.warn("quit chatroom fail ->code+:"+mn[n]+","+r),e.abrupt("return",Promise.reject({code:n,msg:mn[n]}));case 8:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"getInfo",value:(m=o(regeneratorRuntime.mark((function e(){var r,n,o,a,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},t.assert("options.count",r.count,t.AssertRules.NUMBER),t.assert("options.order",r.order,(function(e){return[0,1,2].includes(e)})),n="id:"+this._id,gn.debug("get chatroom info ->"+n),e.next=7,this._context.getChatroomInfo(this._id,r.count,r.order);case 7:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS||!s){e.next=12;break}return e.abrupt("return",s);case 12:return gn.warn("get chatroom info fail ->code+:"+mn[a]+","+n),e.abrupt("return",Promise.reject({code:a,msg:mn[a]}));case 14:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"setEntry",value:(h=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lo(r),n="id:"+this._id,gn.debug("set chatroom entry->"+n),e.next=5,this._context.setChatroomEntry(this._id,r);case 5:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=9;break}return gn.warn("set chatroom entry fail ->code+:"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"setEntries",value:(g=o(regeneratorRuntime.mark((function e(r){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Do(r),!(r.entries.length>10)){e.next=3;break}return e.abrupt("return",Promise.reject(hn.CHATROOM_KV_STORE_OUT_LIMIT));case 3:return n="id:"+this._id,gn.debug("set chatroom entry->"+n),e.next=7,this._context.setChatroomEntries(this._id,r);case 7:if(o=e.sent,a=o.code,s=o.data,a===t.ErrorCode.SUCCESS){e.next=13;break}return gn.warn("set chatroom entry fail ->code+:"+mn[a]+","+n),e.abrupt("return",Promise.reject({code:a,msg:mn[a],data:s}));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"forceSetEntry",value:(l=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lo(r),n="id:"+this._id,gn.debug("force set chatroom entry ->"+n),e.next=5,this._context.forceSetChatroomEntry(this._id,r);case 5:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=9;break}return gn.warn("force set chatroom entry fail ->code+:"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"removeEntry",value:(p=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Go(r),n="id:"+this._id,gn.debug("remove chatroom entry->"+n),e.next=5,this._context.removeChatroomEntry(this._id,r);case 5:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=9;break}return gn.warn("remove chatroom entry fail ->code+:"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"removeEntries",value:(d=o(regeneratorRuntime.mark((function e(r){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Bo(r),n="id:"+this._id,gn.debug("remove chatroom entry->"+n),(o=Object.assign({},r)).entries=r.entries.map((function(e){return{key:e}})),e.next=7,this._context.removeChatroomEntries(this._id,o);case 7:if(a=e.sent,s=a.code,i=a.data,s===t.ErrorCode.SUCCESS){e.next=13;break}return gn.warn("remove chatroom entry fail ->code+:"+mn[s]+","+n),e.abrupt("return",Promise.reject({code:s,msg:mn[s],data:i}));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"forceRemoveEntry",value:(f=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Go(r),n="id:"+this._id,gn.debug("force remove chatroom entry ->"+n),e.next=5,this._context.forceRemoveChatroomEntry(this._id,r);case 5:if((o=e.sent)===t.ErrorCode.SUCCESS){e.next=9;break}return gn.warn("force remove chatroom entry fail ->code+:"+mn[o]+","+n),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"getEntry",value:(c=o(regeneratorRuntime.mark((function e(r){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("key",r,(function(e){return t.isString(e)&&/[\w+=-]+/.test(e)&&e.length<=128}),!0),n="id:"+this._id,gn.debug("get chatroom entry->"+n),e.next=5,this._context.getChatroomEntry(this._id,r);case 5:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS||!s){e.next=10;break}return e.abrupt("return",s);case 10:return gn.warn("get chatroom entry fail ->code+:"+mn[a]+","+n),e.abrupt("return",Promise.reject({code:a,msg:mn[a]}));case 12:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"getAllEntries",value:(u=o(regeneratorRuntime.mark((function e(){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="id:"+this._id,gn.debug("get all chatroom entries->"+r),e.next=4,this._context.getAllChatroomEntries(this._id);case 4:if(n=e.sent,o=n.code,a=n.data,o!==t.ErrorCode.SUCCESS||!a){e.next=9;break}return e.abrupt("return",a);case 9:return gn.warn("get all chatroom entries fail ->code+:"+mn[o]+","+r),e.abrupt("return",Promise.reject({code:o,msg:mn[o]}));case 11:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"send",value:(s=o(regeneratorRuntime.mark((function e(r){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return En(r),n="id:"+this._id,gn.debug("send chatroom message ->"+n),Object.prototype.hasOwnProperty.call(r,"isPersited")||(r.isPersited=!0),Object.prototype.hasOwnProperty.call(r,"isCounted")||(r.isCounted=!0),e.next=7,this._context.sendMessage(t.ConversationType.CHATROOM,this._id,r);case 7:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS){e.next=12;break}return e.abrupt("return",Sn(s));case 12:return gn.warn("send chatroom message fail ->code+:"+mn[a]+","+n),e.abrupt("return",Promise.reject({code:a,msg:mn[a]}));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getMessages",value:(n=o(regeneratorRuntime.mark((function e(r){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.timestamp",r.timestamp,t.AssertRules.NUMBER),t.assert("options.count",r.count,t.AssertRules.NUMBER),t.assert("options.order",r.order,(function(e){return 0===e||1===e})),n="id:"+this._id,gn.debug("get chatroom history message->"+n),e.next=7,this._context.getChatRoomHistoryMessages(this._id,r.count,r.order,r.timestamp);case 7:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS||!s){e.next=13;break}return i=s.list.map((function(e){return Sn(e)})),e.abrupt("return",{list:i,hasMore:s.hasMore});case 13:return gn.warn("get chatroom history message fail ->code+:"+mn[a]+","+n),e.abrupt("return",Promise.reject({code:a,msg:mn[a]}));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"recall",value:(r=o(regeneratorRuntime.mark((function e(r){var n,o,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.messageUId",r.messageUId,t.AssertRules.STRING,!0),t.assert("options.sentTime",r.sentTime,t.AssertRules.NUMBER,!0),n="id:"+this._id+",messageUId:"+r.messageUId,gn.debug("chatroom recall->"+n),o=t.ConversationType.CHATROOM,e.next=7,this._context.recallMessage(o,this._id,r.messageUId,r.sentTime,{channelId:"",user:r.user});case 7:if(a=e.sent,s=a.code,i=a.data,s!==t.ErrorCode.SUCCESS||!i){e.next=12;break}return e.abrupt("return",Sn(i));case 12:return gn.warn("chatroom recall fail->code+:"+mn[s]+","+n),e.abrupt("return",Promise.reject({code:s,msg:mn[s]}));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),e}(),Vo=function(){function e(t){a(this,e),this._context=t}return i(e,[{key:"get",value:function(e){return t.assert("option.id",e.id,t.notEmptyString,!0),new Fo(this._context,e.id)}}]),e}(),Ho=function(){function e(t,r){a(this,e),this._options=t,this._context=r,this._roomId=t.id}var r,n,s,u,c,d,p,l,g,h,m,v,y,S,C;return i(e,[{key:"join",value:(C=o(regeneratorRuntime.mark((function e(){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="roomId:"+this._roomId,gn.debug("join ->"+r),e.next=4,this._context.joinRTCRoom(this._roomId,this._options.mode,this._options.broadcastType);case 4:if(n=e.sent,o=n.code,a=n.data,o!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",a);case 9:return gn.warn("join fail ->"+o+":"+mn[o]+","+r),e.abrupt("return",Promise.reject(o));case 11:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"quit",value:(S=o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="roomId:"+this._roomId,gn.debug("quit ->"+r),e.next=4,this._context.quitRTCRoom(this._roomId);case 4:if((n=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",n);case 7:return gn.warn("quit fail ->"+n+":"+mn[n]+","+r),e.abrupt("return",Promise.reject(n));case 9:case"end":return e.stop()}}),e,this)}))),function(){return S.apply(this,arguments)})},{key:"getRoomInfo",value:(y=o(regeneratorRuntime.mark((function e(){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="roomId:"+this._roomId,gn.debug("get roomInfo ->"+r),e.next=4,this._context.getRTCRoomInfo(this._roomId);case 4:if(n=e.sent,o=n.code,a=n.data,o!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",a);case 9:return gn.warn("get roomInfo fail ->"+o+":"+mn[o]+","+r),e.abrupt("return",Promise.reject(o));case 11:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"setUserInfo",value:(v=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="roomId:"+this._roomId+",key:"+r.key+",value:"+r.value,gn.debug("set userInfo ->"+n),e.next=4,this._context.setRTCUserInfo(this._roomId,r.key,r.value);case 4:if((o=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",o);case 7:return gn.warn("set userInfo fail ->"+o+":"+mn[o]+","+n),e.abrupt("return",Promise.reject(o));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"removeUserInfo",value:(m=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="roomId:"+this._roomId+",keys:"+(r.keys||[]).join(","),gn.debug("remove useerInfo ->"+n),e.next=4,this._context.removeRTCUserInfo(this._roomId,r.keys);case 4:if((o=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",o);case 7:return gn.warn("remove userInfo fail ->"+o+":"+mn[o]+","+n),e.abrupt("return",Promise.reject(o));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"setData",value:(h=o(regeneratorRuntime.mark((function e(r,n,o,a,s){var i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i="roomId:"+this._roomId+",key:"+r+",value:"+n,gn.debug("set data ->"+i),e.next=4,this._context.setRTCData(this._roomId,r,n,o,a,s);case 4:if((u=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",u);case 7:return gn.warn("set data fail ->"+u+":"+mn[u]+","+i),e.abrupt("return",Promise.reject(u));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,o){return h.apply(this,arguments)})},{key:"setUserData",value:function(e,r,n,o){return this.setData(e,r,n,t.RTCApiType.PERSON,o)}},{key:"setRTCUserData",value:(g=o(regeneratorRuntime.mark((function e(r,n,o){var a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="roomId:"+this._roomId,gn.debug("set rtc user ->"+a),e.next=4,this._context.setRTCTotalRes(this._roomId,r,n,o);case 4:if((s=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",s);case 7:return gn.warn("set rtc user fail ->"+s+":"+mn[s]+","+a),e.abrupt("return",Promise.reject(s));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return g.apply(this,arguments)})},{key:"getData",value:(l=o(regeneratorRuntime.mark((function e(r,n,o){var a,s,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="roomId:"+this._roomId,gn.debug("get data ->"+a),e.next=4,this._context.getRTCData(this._roomId,r,n,o);case 4:if(s=e.sent,i=s.code,u=s.data,i!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",u);case 9:return gn.warn("get data fail ->"+i+":"+mn[i]+","+a),e.abrupt("return",Promise.reject(i));case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return l.apply(this,arguments)})},{key:"getUserData",value:function(e,r){return this.getData(e,r,t.RTCApiType.PERSON)}},{key:"removeData",value:(p=o(regeneratorRuntime.mark((function e(r,n,o,a){var s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="roomId:"+this._roomId+",keys:"+r.join(","),gn.debug("remove data ->"+s),e.next=4,this._context.removeRTCData(this._roomId,r,n,o,a);case 4:if((i=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",i);case 7:return gn.warn("remove data fail ->"+i+":"+mn[i]+","+s),e.abrupt("return",Promise.reject(i));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return p.apply(this,arguments)})},{key:"removeUserData",value:function(e,r,n){return this.removeData(e,r,t.RTCApiType.PERSON,n)}},{key:"setRoomData",value:function(e,r,n,o){return this.setData(e,r,n,t.RTCApiType.ROOM,o)}},{key:"getRoomData",value:function(e,r){return this.getData(e,r,t.RTCApiType.ROOM)}},{key:"removeRoomData",value:function(e,r,n){return this.removeData(e,r,t.RTCApiType.ROOM,n)}},{key:"setState",value:(d=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="roomId:"+this._roomId,gn.debug("set state ->"+n),e.next=4,this._context.setRTCState(this._roomId,r.report);case 4:if((o=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",o);case 7:return gn.warn("set state fail ->"+o+":"+mn[o]+","+n),e.abrupt("return",Promise.reject(o));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"getUserList",value:(c=o(regeneratorRuntime.mark((function e(){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="roomId:"+this._roomId,gn.debug("get userList ->"+r),e.next=4,this._context.getRTCUserInfoList(this._roomId);case 4:if(n=e.sent,o=n.code,a=n.data,o!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",a);case 9:return gn.warn("get userList fail ->"+o+":"+mn[o]+","+r),e.abrupt("return",Promise.reject(o));case 11:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"getUserInfoList",value:(u=o(regeneratorRuntime.mark((function e(){var r,n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="roomId:"+this._roomId,gn.debug("get userInfo list ->"+r),e.next=4,this._context.getRTCUserInfoList(this._roomId);case 4:if(n=e.sent,o=n.code,a=n.data,o!==t.ErrorCode.SUCCESS){e.next=10;break}return s=null==a?void 0:a.users,e.abrupt("return",s);case 10:return gn.warn("get userInfo list fail ->"+o+":"+mn[o]+","+r),e.abrupt("return",Promise.reject(o));case 12:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getToken",value:(s=o(regeneratorRuntime.mark((function e(){var r,n,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="roomId:"+this._roomId,gn.debug("getToken ->"+r),e.next=4,this._context.getRTCToken(this._roomId,this._options.mode,this._options.broadcastType);case 4:if(n=e.sent,o=n.data,(a=n.code)!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",o);case 9:return gn.warn("getToken fail ->"+a+":"+mn[a]+","+r),e.abrupt("return",Promise.reject(a));case 11:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"ping",value:(n=o(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="roomId:"+this._roomId,gn.debug("ping ->"+r),e.next=4,this._context.rtcPing(this._roomId,this._options.mode,this._options.broadcastType);case 4:if((n=e.sent)!==t.ErrorCode.SUCCESS){e.next=7;break}return e.abrupt("return",n);case 7:return gn.warn("ping fail ->"+n+":"+mn[n]+","+r),e.abrupt("return",Promise.reject(n));case 9:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"send",value:(r=o(regeneratorRuntime.mark((function e(r){var n,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="roomId:"+this._roomId,gn.debug("send ->"+n),e.next=4,this._context.sendMessage(t.ConversationType.RTC_ROOM,this._roomId,{content:f({},r.content),messageType:r.messageType});case 4:if(o=e.sent,a=o.code,s=o.data,a!==t.ErrorCode.SUCCESS){e.next=9;break}return e.abrupt("return",s);case 9:return gn.warn("send fail ->"+a+":"+mn[a]+","+n),e.abrupt("return",Promise.reject(a));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}]),e}(),Ko=[].slice,qo=/MSIE .\./.test(Ze),Wo=function(e){return function(t,r){var n=arguments.length>2,o=n?Ko.call(arguments,2):void 0;return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,o)}:t,r)}};We({global:!0,bind:!0,forced:qo},{setTimeout:Wo(y.setTimeout),setInterval:Wo(y.setInterval)});var Yo,Xo,Jo=function(){return!("undefined"==typeof uni||!function(e){for(var t=["canIUse","getSystemInfo"],r=0,n=t.length;r<n;r++)if(!e[t[r]])return!1;return!0}(uni))},Qo=Jo();var zo={tag:"browser",httpReq:function(e){var n=e.method||t.HttpMethod.GET,o=e.timeout||6e4,a=e.headers,s=e.query,i=e.body,u=t.appendUrl(e.url,s);return new Promise((function(e){var t,s=(t="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,"undefined"!=typeof XMLHttpRequest&&t?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")),c="[object XDomainRequest]"===Object.prototype.toString.call(s);if(s.open(n,u),a&&s.setRequestHeader)for(var f in a)s.setRequestHeader(f,a[f]);if(c){s.timeout=o,s.onload=function(){e({data:s.responseText,status:s.status||200})},s.onerror=function(){e({status:s.status||0})},s.ontimeout=function(){e({status:s.status||0})};var d="object"===r(i)?JSON.stringify(i):i;s.send(d)}else s.onreadystatechange=function(){4===s.readyState&&e({data:s.responseText,status:s.status})},s.onerror=function(){e({status:s.status||0})},setTimeout((function(){return e({status:s.status||0})}),o),s.send(i)}))},localStorage:null===(Yo=window)||void 0===Yo?void 0:Yo.localStorage,sessionStorage:null===(Xo=window)||void 0===Xo?void 0:Xo.sessionStorage,isSupportSocket:function(){var e="undefined"!=typeof WebSocket;return e||gn.warn("websocket not support"),e},useNavi:!0,connectPlatform:"",isFromUniapp:Qo,createWebSocket:function(e,t){var r=new WebSocket(e,t);return r.binaryType="arraybuffer",{onClose:function(e){r.onclose=function(t){var r=t.code,n=t.reason;e(r,n)}},onError:function(e){r.onerror=e},onMessage:function(e){r.onmessage=function(t){e(t.data)}},onOpen:function(e){r.onopen=e},send:function(e){r.send(e)},close:function(e,t){r.close(e,t)}}},createDataChannel:function(e,r){return this.isSupportSocket()&&"websocket"===r?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},Zo=Jo(),$o=function(e){return function(){try{var t;return(t=wx)[e].apply(t,arguments)}catch(e){gn.error(e)}}},ea={setItem:$o("setStorageSync"),getItem:$o("getStorageSync"),removeItem:$o("removeStorageSync"),clear:$o("clearStorageSync")},ta={tag:"wechat",httpReq:function(e){var r=e.method||t.HttpMethod.GET,n=e.timeout||6e4,o=e.headers,a=e.query,s=e.body,i=t.appendUrl(e.url,a);return new Promise((function(e){wx.request({url:i,method:r,headers:o,timeout:n,data:s,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:ea,sessionStorage:ea,isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:Zo,createWebSocket:function(e,t){var r=wx.connectSocket({url:e,protocols:t});return{onClose:function(e){r.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){r.onError((function(t){e(t.errMsg)}))},onMessage:function(e){r.onMessage((function(t){e(t.data)}))},onOpen:function(e){r.onOpen(e)},send:function(e){r.send({data:e})},close:function(e,t){r.close({code:e,reason:t})}}},createDataChannel:function(e,r){return"websocket"===r?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},ra=Jo(),na=function(e){return function(){try{var t;return(t=my)[e].apply(t,arguments)}catch(e){gn.error(e)}}},oa={setItem:na("setStorageSync"),getItem:na("getStorageSync"),removeItem:na("removeStorageSync"),clear:na("clearStorageSync")},aa={tag:"alipay",httpReq:function(e){var r=e.method||t.HttpMethod.GET,n=e.timeout||6e4,o=e.headers,a=e.query,s=e.body,i=t.appendUrl(e.url,a);return new Promise((function(e){my.request({url:i,method:r,headers:o,timeout:n,data:s,success:function(t){e({data:t.data,status:t.status})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:oa,sessionStorage:oa,isSupportSocket:function(){return!1},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:ra,createDataChannel:function(e,r){return"websocket"===r?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},sa=Jo(),ia=function(e){return function(){try{var t;return console.log("tt",tt),(t=tt)[e].apply(t,arguments)}catch(e){gn.error(e)}}},ua={setItem:ia("setStorageSync"),getItem:ia("getStorageSync"),removeItem:ia("removeStorageSync"),clear:ia("clearStorageSync")},ca={tag:"toutiao",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:sa,localStorage:ua,sessionStorage:ua,httpReq:function(e){return new Promise((function(t,r){tt.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("调用成功",e.data);var r=(null==e?void 0:e.data)||{},n={data:JSON.stringify(r),status:e.statusCode};t(n)},fail:function(e){console.log("调用失败",e.errMsg),r({data:e.errMsg})}})}))},createWebSocket:function(e,t){var r=tt.connectSocket({url:e,protocols:t});return{onOpen:function(e){r.onOpen(e)},onClose:function(e){r.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){r.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){r.onMessage((function(t){return e(t.data)}))},send:function(e){r.send({data:e})},close:function(e,t){r.close({code:e,reason:t})}}},createDataChannel:function(e,r){return"websocket"===r?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},fa=Jo(),da=function(e){return function(){try{var t;return console.log("swan",swan),(t=swan)[e].apply(t,arguments)}catch(e){gn.error(e)}}},pa={setItem:da("setStorageSync"),getItem:da("getStorageSync"),removeItem:da("removeStorageSync"),clear:da("clearStorageSync")},la={tag:"baidu",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:fa,localStorage:pa,sessionStorage:pa,httpReq:function(e){return new Promise((function(t,r){swan.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("调用成功",e.data);var r=(null==e?void 0:e.data)||{},n={data:JSON.stringify(r),status:e.statusCode};t(n)},fail:function(e){console.log("调用失败",e.errorCode),r({data:e.errorCode})}})}))},createWebSocket:function(e,t){var r=swan.connectSocket({url:e,protocols:t});return{onOpen:function(e){r.onOpen(e)},onClose:function(e){r.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){r.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){r.onMessage((function(t){return e(t.data)}))},send:function(e){r.send({data:e})},close:function(e,t){r.close({code:e,reason:t})}}},createDataChannel:function(e,r){return"websocket"===r?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},ga=function(e){return function(){try{var t;return(t=uni)[e].apply(t,arguments)}catch(e){gn.error(e)}}},ha={setItem:ga("setStorageSync"),getItem:ga("getStorageSync"),removeItem:ga("removeStorageSync"),clear:ga("clearStorageSync")},ma={tag:"uniapp",httpReq:function(e){var r=e.method||t.HttpMethod.GET,n=e.timeout||6e4,o=e.headers,a=e.query,s=e.body,i=t.appendUrl(e.url,a);return new Promise((function(e){uni.request({url:i,method:r,headers:o,timeout:n,sslVerify:!1,data:s,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:t.ErrorCode.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:ha,sessionStorage:ha,isSupportSocket:function(){return!0},useNavi:!0,connectPlatform:"",isFromUniapp:!0,createWebSocket:function(e,t){var r={complete:function(){},url:e,protocols:t},n=uni.connectSocket(r);return{onClose:function(e){n.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){e(t.data)}))},onOpen:function(e){n.onOpen(e)},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,r){return"websocket"===r?new t.WebSocketChannel(this,e):new t.CometChannel(this,e)}},va=function(e){return e&&e.canIUse&&e.getSystemInfo},ya="undefined"!=typeof uni&&va(uni)?function(){switch(process.env.VUE_APP_PLATFORM){case"app-plus":return ma;case"mp-baidu":return la;case"mp-toutiao":return ca;case"mp-alipay":return aa;case"mp-weixin":return ta;case"h5":default:return zo}}():"undefined"!=typeof wx&&va(wx)?ta:"undefined"!=typeof my&&va(my)?aa:"undefined"!=typeof tt&&va(tt)?ca:"undefined"!=typeof swan&&va(swan)?la:zo;t.VersionManage.add("imlib","4.5.1"),t.VersionManage.validEngine("~4.5.1")||gn.error("The current engine version '".concat(t.VersionManage.getInfo().engine,"' error，imlib required engine version at least '","~4.5.1","'."));var Sa,Ca=[],Ea=[],Ra={message:function(e){Ca.forEach((function(t){return t(e)}))},status:function(e){Ea.forEach((function(t){return t(e)}))}},ba=function(){function e(r){a(this,e),this._token="",this._context=r,this.Conversation=new Vn(r),this.ChatRoom=new Vo(r),this.Tag=new Kn(r),this.RTC=function(e){return t.assert("options.id",e.id,t.notEmptyString,!0),new Ho(e,r)}}var r,n,s;return i(e,[{key:"install",value:function(e,t){return this._context.install(e,t)}},{key:"watch",value:function(e){var t=e.status,r=e.conversation,n=e.message,o=e.chatroom,a=e.expansion,s=e.typingStatus,i=e.pullFinished,u=e.messageBlocked,c=e.tag,f={};t&&(f.connectionState=function(e){try{t({status:e})}catch(e){gn.error(e)}}),r&&(f.conversationState=function(e){try{var t=e.map((function(e){return r=(t=e).updatedItems,n=t.conversationType,o=t.targetId,a=t.latestMessage,s=t.unreadMessageCount,i=t.lastUnreadTime,u=t.notificationStatus,c=t.isTop,f=t.mentionedInfo,d=t.hasMentioned,p=a&&Sn(a),r&&r.latestMessage&&(r.latestMessage.val=p),{updatedItems:r,type:n,targetId:o,latestMessage:p,unreadMessageCount:s,lastUnreadTime:i,notificationStatus:u,isTop:c,mentionedInfo:f,hasMentioned:d};var t,r,n,o,a,s,i,u,c,f,d,p}));r({updatedConversationList:t})}catch(e){gn.error(e)}}),n&&(f.message=function(e){try{n({message:Sn(e)})}catch(e){gn.error(e)}}),o&&(f.chatroomState=function(e){try{o(e)}catch(e){gn.error(e)}}),a&&(f.expansion=function(e){try{a(e)}catch(e){gn.error(e)}}),i&&(f.pullFinished=function(){try{i()}catch(e){gn.error(e)}}),s&&(f.typingState=function(e){try{s(e)}catch(e){gn.error(e)}}),u&&(f.messageBlocked=function(e){try{u(e)}catch(e){gn.error(e)}}),c&&(f.tag=function(){try{c()}catch(e){gn.error(e)}}),this._context.assignWatcher(f)}},{key:"unwatch",value:function(){this._context.assignWatcher({message:void 0,connectionState:void 0,conversationState:void 0,chatroomState:void 0,expansion:void 0,pullFinished:void 0,typingState:void 0,messageBlocked:void 0})}},{key:"rtcInnerWatch",value:function(e){var t=e.message,r=e.status;t&&Ca.push((function(e){try{t({message:Sn(e)})}catch(e){gn.error(e)}})),r&&Ea.push((function(e){try{r({status:e})}catch(e){gn.error(e)}})),this._context.assignWatcher({rtcInnerWatcher:Ra})}},{key:"rtcInnerUnwatch",value:function(){Ea.length=Ea.length=0,this._context.assignWatcher({rtcInnerWatcher:void 0})}},{key:"connect",value:(s=o(regeneratorRuntime.mark((function e(r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assert("options.token",r.token,t.AssertRules.STRING,!0),n=r.token,this._token=n,e.next=5,this._context.connect(n,!0);case 5:if((o=e.sent).code!==t.ErrorCode.SUCCESS){e.next=8;break}return e.abrupt("return",{id:o.userId});case 8:return e.abrupt("return",Promise.reject({code:o.code,msg:mn[o.code]}));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"reconnect",value:(n=o(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._context.reconnect();case 2:if((r=e.sent).code!==t.ErrorCode.SUCCESS){e.next=5;break}return e.abrupt("return",{id:r.userId});case 5:return e.abrupt("return",Promise.reject({code:r.code,msg:mn[r.code]}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"disconnect",value:function(){return this._context.disconnect()}},{key:"getAppInfo",value:function(){return{appkey:this._context.appkey,token:this._token,navi:this._context.getInfoFromCache()}}},{key:"getConnectedTime",value:function(){return this._context.getConnectedTime()}},{key:"getServerTime",value:function(){return this._context.getServerTime()}},{key:"getConnectionStatus",value:function(){return this._context.getConnectionStatus()}},{key:"getConnectionUserId",value:function(){return this._context.getCurrentUserId()}},{key:"getFileToken",value:function(e,r,n,o){return t.assert("fileType",e,t.isValidFileType,!0),this._context.getFileToken(e,r,n,o)}},{key:"getFileUrl",value:function(e,r,n,o,a){return t.assert("fileType",e,t.isValidFileType,!0),t.assert("filename",r,t.AssertRules.STRING),t.assert("saveName",n,t.AssertRules.STRING),t.assert("serverType",a,t.AssertRules.NUMBER),this._context.getFileUrl(e,r,n,o,a)}},{key:"changeUser",value:(r=o(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return gn.warn("Method is deprecated"),t.assert("options.token",r.token,t.AssertRules.STRING,!0),e.next=4,this.disconnect();case 4:return e.abrupt("return",this.connect(r));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"registerMessageType",value:function(e,t,r,n){this._context.registerMessageType(e,t,r,n)}}]),e}(),Ia=t.MessageDirection,Ta=t.ConversationType,xa=t.FileType,wa={DO_NOT_DISTURB:t.NotificationStatus.OPEN,NOTIFY:t.NotificationStatus.CLOSE},_a=t.ChatroomEntryType;Object.defineProperty(e,"ChatroomEntryType",{enumerable:!0,get:function(){return t.ChatroomEntryType}}),Object.defineProperty(e,"ConnectionStatus",{enumerable:!0,get:function(){return t.ConnectionStatus}}),Object.defineProperty(e,"ConversationType",{enumerable:!0,get:function(){return t.ConversationType}}),Object.defineProperty(e,"FileType",{enumerable:!0,get:function(){return t.FileType}}),Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return t.LogLevel}}),Object.defineProperty(e,"MessageDirection",{enumerable:!0,get:function(){return t.MessageDirection}}),Object.defineProperty(e,"NotificationStatus",{enumerable:!0,get:function(){return t.NotificationStatus}}),Object.defineProperty(e,"UploadMethod",{enumerable:!0,get:function(){return t.UploadMethod}}),e.CHATROOM_ENTRY_TYPE=_a,e.CHATROOM_ORDER={ASC:1,DESC:2},e.CONNECTION_STATUS={CONNECTED:0,CONNECTING:1,DISCONNECTED:2,NETWORK_UNAVAILABLE:3,SOCKET_ERROR:4,KICKED_OFFLINE_BY_OTHER_CLIENT:6,BLOCKED:12},e.CONNECT_TYPE={COMET:"comet",WEBSOCKET:"websocket"},e.CONVERSATION_TYPE=Ta,e.ERROR_CODE=mn,e.FILE_TYPE=xa,e.IMClient=ba,e.MENTIONED_TYPE={ALL:1,SINGAL:2},e.MESSAGE_DIRECTION=Ia,e.MESSAGE_TYPE={TEXT:"RC:TxtMsg",VOICE:"RC:VcMsg",HQ_VOICE:"RC:HQVCMsg",IMAGE:"RC:ImgMsg",GIF:"RC:GIFMsg",RICH_CONTENT:"RC:ImgTextMsg",LOCATION:"RC:LBSMsg",FILE:"RC:FileMsg",SIGHT:"RC:SightMsg",COMBINE:"RC:CombineMsg",CHRM_KV_NOTIFY:"RC:chrmKVNotiMsg",LOG_COMMAND:"RC:LogCmdMsg",EXPANSION_NOTIFY:"RC:MsgExMsg",REFERENCE:"RC:ReferenceMsg"},e.MESSAGS_TIME_ORDER={DESC:0,ASC:1},e.NOTIFICATION_STATUS=wa,e.RECALL_MESSAGE_TYPE="RC:RcCmd",e.RECEIVED_STATUS={READ:1,LISTENED:2,DOWNLOADED:4,RETRIEVED:8,UNREAD:0},e.SDK_VERSION="4.5.1",e.getInstance=function(){return Sa||gn.error("Please call the init method first"),Sa},e.init=function(e){if(gn.setLogLevel(e.logLevel),gn.setLogStdout(e.logStdout),Sa)return gn.error("The instance already exists. Do not repeatedly call the init method"),Sa;t.assert("options.appkey",e.appkey,t.AssertRules.STRING,!0),t.assert("options.debug",e.debug,t.AssertRules.BOOLEAN),t.assert("options.navigators",e.navigators,(function(e){return t.isArray(e)&&(0===e.length||e.every(t.isHttpUrl))}));var r=null==e?void 0:e.connectType;r?t.CONNECTION_TYPE.WEBSOCKET!==r&&t.CONNECTION_TYPE.COMET!==r&&(gn.warn("RongIMLib connectionType must be ".concat(t.CONNECTION_TYPE.WEBSOCKET," or ").concat(t.CONNECTION_TYPE.COMET)),r=t.CONNECTION_TYPE.WEBSOCKET):r=t.CONNECTION_TYPE.WEBSOCKET;var n=t.APIContext.init(ya,{appkey:e.appkey,apiVersion:"4.5.1",navigators:e.navigators||[],miniCMPProxy:e.customCMP||[],connectionType:r,logLevel:e.logLevel,logStdout:e.logStdout,indexDBSwitch:e.indexDBSwitch,checkCA:e.checkCA});return gn.warn("RongIMLib Version: ".concat("4.5.1",", Commit: ","b3fede6623187cfd78369f9fc81cc5b70226faf9")),Sa=new ba(n)},Object.defineProperty(e,"__esModule",{value:!0})}));
